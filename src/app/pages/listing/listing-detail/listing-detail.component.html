<div id="splash-screen" class="splash-screen" *ngIf="IsLoading">
  <img src="./assets/media/logos/prophero-small.svg" alt="PropHero logo" />
  <span>Loading ...</span>
</div>
<div
  id="kt_activities"
  class="bg-body"
  data-kt-drawer="true"
  data-kt-drawer-name="activities"
  data-kt-drawer-activate="true"
  data-kt-drawer-overlay="false"
  data-kt-drawer-width="{default:'300px', 'lg': '900px'}"
  data-kt-drawer-direction="end"
  data-kt-drawer-toggle=".kt_activities_toggle"
  data-kt-drawer-close="#kt_activities_close"
  #container
>
  <div class="card shadow-none rounded-0 w-100">
    <form [formGroup]="form" novalidate="" class="form">
      <div class="card-header" id="kt_activities_header">
        <div>
          <div class="card-title fw-bold text-dark">
            {{ isEdit ? form.value.reference : "New Listing" }}

            <div class="ms-2" [hidden]="!isEdit">
              <!--begin::Dropview toggle-->
              <a
                class="btn btn-icon btn-sm"
                data-kt-menu-trigger="{default: 'hover'}"
                data-kt-menu-attach="parent"
                data-kt-menu-placement="bottom-start"
              >
                <i class="bi bi-clock fs-3"></i>
              </a>
              <!--end::Dropview toggle-->

              <!--begin::Dropview-->
              <div
                class="menu menu-sub menu-sub-dropdown p-4"
                data-kt-menu="true"
              >
                <small>
                  Created: {{ createdDate | date : "dd/MM/yyyy hh:mm:ss a "
                  }}<br />
                  Updated: {{ updatedDate | date : "dd/MM/yyyy hh:mm:ss a"
                  }}<br />
                  <span *ngIf="lastPublishedDate !== null">Last Published:
                  {{ lastPublishedDate | date : "dd/MM/yyyy hh:mm:ss a" }}<br />
                  </span>
                </small>
              </div>
              <!--end::Dropview-->
            </div>
          </div>

          <ng-template #AddOwnerContactModel>
            <div
              class="modal-content advance-filter-modal"
              style="width: 90rem; position: relative; right: 14rem"
            >
              <div class="modal-header py-3">
                <!--begin::Modal title-->
                <h4 class="m-0">Owner Contact</h4>
                <!--end::Modal title-->
                <div
                  class="btn btn-sm btn-icon btn-active-color-primary"
                  (click)="closeContact()"
                >
                  <i class="ki-duotone ki-cross fs-1"
                    ><span class="path1"></span><span class="path2"></span
                  ></i>
                </div>
              </div>

              <div>
                <form [formGroup]="searchContactForm">
                  <div class="">
                    <div class="table-responsive">
                      <!-- begin::Table -->
                      <table
                        id="listings_row"
                        class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4"
                      >
                        <!-- begin::Table head -->
                        <thead class="fw-bold">
                          <th class="w-40px">
                            <div
                              class="form-check form-check-sm form-check-custom form-check-solid p-0"
                            >
                              <!-- <input
                                class="form-check-input"
                                type="radio"
                                value="1"
                                data-kt-check="true"
                                data-kt-check-target=".widget-9-check"
                              /> -->
                            </div>
                          </th>

                          <!--Basic Details-->
                          <th class="min-w-120px" (click)="OnSort('Ref')">
                            Reference
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('AssignedTo')"
                          >
                            Assigned To
                          </th>

                          <th class="min-w-120px" (click)="OnSort('Title')">
                            Title
                          </th>
                          <th class="min-w-120px" (click)="OnSort('FirstName')">
                            First Name
                          </th>
                          <th class="min-w-120px" (click)="OnSort('LastName')">
                            Last Name
                          </th>

                          <!-- Contact Details -->
                          <th
                            class="min-w-120px"
                            (click)="OnSort('PersonalMobile')"
                          >
                            Personal Mobile
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('WorkMobile')"
                          >
                            Work Mobile
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('OtherMobile')"
                          >
                            Other Mobile
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('PersonalPhone')"
                          >
                            Personal Phone
                          </th>
                          <th class="min-w-120px" (click)="OnSort('WorkPhone')">
                            Work Phone
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('OtherPhone')"
                          >
                            Other Phone
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('PersonalEmail')"
                          >
                            Personal Email
                          </th>
                          <th class="min-w-120px" (click)="OnSort('WorkEmail')">
                            Work Email
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('OtherEmail')"
                          >
                            Other Email
                          </th>
                          <!-- <th class="min-w-120px" (click)="OnSort('PersonalFax')"> Personal Fax </th>
                        <th class="min-w-120px" (click)="OnSort('WorkFax')"> Work Fax </th>
                        <th class="min-w-120px" (click)="OnSort('OtherFax')"> Other Fax </th> -->
                          
                          <th
                            class="min-w-120px"
                            (click)="OnSort('ContactType')"
                          >
                            Contact Type
                          </th>
                          <!-- <th class="min-w-120px" (click)="OnSort('Created')">
                            Created
                          </th>
                          <th class="min-w-120px" (click)="OnSort('CreatedBy')">
                            Created By
                          </th>
                          <th class="min-w-120px" (click)="OnSort('Updated')">
                            Updated
                          </th>
                          <th class="min-w-120px" (click)="OnSort('UpdatedBy')">
                            Updated By
                          </th> -->
                        </thead>
                        <!-- end::Table head -->

                        <!-- begin::Table Filter -->
                        <thead id="filter">
                          <!-- <form [formGroup]="searchContactForm"> -->
                          <th></th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterRef"
                              (keyup)="MinCharSearch($event, 'Ref')"
                            />
                          </th>
                          <th>
                            <ng-select style="margin-left: -8px;
                            width: 142px;"
                              formControlName="filterAssignee"
                              bindLabel="name"
                              (change)="filterContact()"
                            >
                              <!-- <ng-option value="" selected>Select Assign To</ng-option> -->
                              <ng-option
                                *ngFor="let assignee of assignToList"
                                [value]="assignee.id"
                                >
                                <!-- <span class="d-flex gap-2 align-items-center"
                                >
                                <ngx-avatar *ngIf="assignee?.profileImage == null || assignee?.profileImage == ''" size="26" class="avatar" [name]="assignee?.name"></ngx-avatar>
                                <img *ngIf="assignee?.profileImage != null && assignee?.profileImage != ''" [src]="imgUrl + assignee?.profileImage" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="26" [style.height.px]="26">
                                <ngx-avatar
                                  size="26"
                                  class="avatar"
                                  [name]="assignee?.name"
                                ></ngx-avatar>
                                {{ assignee.name }}</span> -->
                                  {{assignee.name}}
                                </ng-option
                              >
                            </ng-select>
                          </th>

                          <th>
                            <ng-select
                              formControlName="filterTitle"
                              bindLabel="name"
                              id="titleId"
                              (change)="filterContact()"
                            >
                              <!-- <ng-option value="" selected>Select</ng-option> -->
                              <ng-option
                                *ngFor="let title of titleList"
                                [value]="title.id"
                                >{{ title.name }}</ng-option
                              >
                            </ng-select>
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterFirstName"
                              (keyup)="MinCharSearch($event, 'FirstName')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterLastName"
                              (keyup)="MinCharSearch($event, 'LastName')"
                            />
                          </th>

                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterPersonalMobile"
                              (keyup)="MinCharSearch($event, 'PersonalMobile')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterWorkMobile"
                              (keyup)="MinCharSearch($event, 'WorkMobile')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterOtherMobile"
                              (keyup)="MinCharSearch($event, 'OtherMobile')"
                            />
                          </th>

                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterPersonalPhone"
                              (keyup)="MinCharSearch($event, 'PersonalPhone')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterWorkPhone"
                              (keyup)="MinCharSearch($event, 'WorkPhone')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterOtherPhone"
                              (keyup)="MinCharSearch($event, 'OtherPhone')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterPersonalEmail"
                              (keyup)="MinCharSearch($event, 'PersonalEmail')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterWorkEmail"
                              (keyup)="MinCharSearch($event, 'WorkEmail')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterOtherEmail"
                              (keyup)="MinCharSearch($event, 'OtherEmail')"
                            />
                          </th>
                          <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalFax" (keyup)="MinCharSearch($event,'PersonalFax')"/></th> -->
                          <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkFax" (keyup)="MinCharSearch($event,'WorkFax')"/></th> -->
                          <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterOtherFax" (keyup)="MinCharSearch($event,'OtherFax')"/></th> -->
                          
                          <th>
                            <ng-select
                              formControlName="filterContactType"
                              bindLabel="name"
                              id="titleId"
                              (change)="filterContact()"
                            >
                              
                              <ng-option
                                *ngFor="let contactType of ContactTypeList"
                                [value]="contactType.id"
                                >{{ contactType.name }}</ng-option
                              >
                            </ng-select>
                          </th>
                          <!-- <th>
                            <div class="d-flex gap-2 w-200px">
                              <div class="position-relative w-50">
                                <input
                                  type="date"
                                  class="form-control mb-3 mb-lg-0"
                                  formControlName="filterCreatedFrom"
                                  (change)="filterContact()"
                                />
                                <span
                                  class="input-date-placeholder"
                                  for="filterCreatedFrom"
                                  >From</span
                                >
                              </div>
                              <div class="position-relative w-50">
                                <input
                                  type="date"
                                  class="form-control mb-3 mb-lg-0"
                                  formControlName="filterCreatedTo"
                                  (change)="filterContact()"
                                />
                                <span
                                  class="input-date-placeholder"
                                  for="filterCreatedTo"
                                  >To</span
                                >
                              </div>
                            </div>
                          </th>
                          <th>
                            <ng-select
                              formControlName="filterCreatedBy"
                              bindLabel="name"
                              id="titleId"
                              (change)="filterContact()"
                            >
                              
                              <ng-option
                                *ngFor="let userData of userList"
                                [value]="userData.id"
                                >{{ userData.name }}</ng-option
                              >
                            </ng-select>
                          </th>
                          <th>
                            <div class="d-flex gap-2 w-200px">
                              <div class="position-relative w-50">
                                <input
                                  type="date"
                                  class="form-control mb-3 mb-lg-0"
                                  formControlName="filterUpdatedFrom"
                                  (change)="filterContact()"
                                />
                                <span
                                  class="input-date-placeholder"
                                  for="filterUpdatedFrom"
                                  >From</span
                                >
                              </div>
                              <div class="position-relative w-50">
                                <input
                                  type="date"
                                  class="form-control mb-3 mb-lg-0"
                                  formControlName="filterUpdatedTo"
                                  (change)="filterContact()"
                                />
                                <span
                                  class="input-date-placeholder"
                                  for="filterUpdatedTo"
                                  >To</span
                                >
                              </div>
                            </div>
                          </th>
                        <th>
                          <ng-select
                            formControlName="filterUpdatedBy"
                            bindLabel="name"
                            id="titleId"
                            (change)="filterContact()"
                          >
                            <ng-option
                              *ngFor="let userData of userList"
                              [value]="userData.id"
                              >{{ userData.name }}</ng-option
                            >
                          </ng-select>
                        </th> -->
                          <!-- </form> -->
                        </thead>

                        <!-- end::Table Filter -->

                        <!-- begin::Table Body -->
                        <tbody *ngIf="ContactDetailsList.length > 0">
                          <tr
                            *ngFor="
                              let data of ContactDetailsList
                                | paginate
                                  : {
                                      id: 'pagination_contact_owner',
                                      itemsPerPage: pageSize,
                                      currentPage: pageNumber,
                                      totalItems: totalRecord,
                                    }
                            "
                          >
                            <th class="w-40px align-middle">
                              <div
                                class="form-check form-check-sm form-check-custom form-check-solid p-0"
                              >
                                <input
                                  class="form-check-input cursor-pointer"
                                  type="radio"
                                  name="ContactOwner"
                                  [checked]="selectedListningOwnerContactId == data?.id" 
                                  (click)="onSelectContact(data?.id)"
                                  value="{{ data.Id }}"
                                  data-kt-check="true"
                                  data-kt-check-target=".widget-9-check"
                                />
                              </div>
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.ref }}
                            </th>
                            <th class="kt_contact-details_toggle">
                              <div class="d-flex gap-2 align-items-center">
                                <ngx-avatar *ngIf="data?.profileImage == null || data?.profileImage == ''" size="26" class="avatar" [name]="data?.agentName"></ngx-avatar>
                                <img *ngIf="data?.profileImage != null && data?.profileImage != ''" [src]="imgUrl + data?.profileImage" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="26" [style.height.px]="26">
                                <!-- <ngx-avatar
                                  size="26"
                                  class="avatar"
                                  [name]="data?.agentName"
                                ></ngx-avatar> -->
                                {{ data?.agentName }}
                              </div>
                            </th>
                            <!--Reference & Status-->
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.titleName }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.firstName }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.lastName }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getMobile(1, data?.mobile) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getMobile(2, data?.mobile) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getMobile(3, data?.mobile) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getPhone(1, data?.phone) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getPhone(2, data?.phone) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getPhone(3, data?.phone) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getEmail(1, data?.email) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getEmail(2, data?.email) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getEmail(3, data?.email) }}
                            </th>
                            <!-- <th>{{getFax(1,data?.fax)}}</th>
                          <th>{{getFax(2,data?.fax)}}</th>
                          <th>{{getFax(3,data?.fax)}}</th> -->
                           
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.contactTypeName }}
                            </th>
                            <!-- <th class="kt_contact-details_toggle align-middle">
                              {{ data?.created | date : "MM/dd/yyyy" }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.createdBy }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.updated | date : "MM/dd/yyyy" }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.updatedBy }}
                            </th> -->
                          </tr>
                        </tbody>
                        <!-- end::Table Body -->
                      </table>
                      <div
                        class="text-center mt-5 mb-5"
                        *ngIf="
                          ContactDetailsList && ContactDetailsList?.length == 0
                        "
                      >
                        Record not available
                      </div>
                      <!-- end::Table -->
                    </div>
                  </div>
                  <div class="modal-footer py-3">
                    <div class="d-flex justify-content-between flex-column-reverse me-auto">
                      <pagination-controls *ngIf="ContactDetailsList.length > 0" (pageChange)="contactRenderPageBy($event)" id="pagination_contact_owner"></pagination-controls>
                      <span class="d-block mb-3">Showing {{ ContactDetailsList.length }} of <b>{{totalRecord}}</b> Contacts</span>
                  </div>
        
                  <button (click)="contactOwnerDataClose()" class="btn btn-sm btn-light btn-active-light-primary me-3">Cancel</button>
                  <button (click)="contactOwnerDataSave()" [disabled]="tempSelectedOwnerContactRef == null"  class="btn btn-sm btn-primary" >Apply</button>
                  </div>
                </form>
              </div>
            </div>
          </ng-template>
          <ng-template #AddTenantContactModel>
            <div
              class="modal-content advance-filter-modal"
              style="width: 90rem; position: relative; right: 14rem"
            >
              <div class="modal-header py-3">
                <!--begin::Modal title-->
                <h4 class="m-0">Tenant Contact</h4>
                <!--end::Modal title-->
                <div
                  class="btn btn-sm btn-icon btn-active-color-primary"
                  (click)="closeTenantContact()"
                >
                  <i class="ki-duotone ki-cross fs-1"
                    ><span class="path1"></span><span class="path2"></span
                  ></i>
                </div>
              </div>

              <div>
                <form [formGroup]="searchContactForm">
                  <div class="">
                    <div class="table-responsive">
                      <!-- begin::Table -->
                      <table
                        id="listings_row"
                        class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4"
                      >
                        <!-- begin::Table head -->
                        <thead class="fw-bold">
                          <th class="w-40px">
                            <div
                              class="form-check form-check-sm form-check-custom form-check-solid p-0"
                            >
                              <!-- <input
                                class="form-check-input"
                                type="radio"
                                value="1"
                                data-kt-check="true"
                                data-kt-check-target=".widget-9-check"
                              /> -->
                            </div>
                          </th>

                          <!--Basic Details-->
                          <th class="min-w-120px" (click)="OnSort('Ref')">
                            Reference
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('AssignedTo')"
                          >
                            Assigned To
                          </th>

                          <th class="min-w-120px" (click)="OnSort('Title')">
                            Title
                          </th>
                          <th class="min-w-120px" (click)="OnSort('FirstName')">
                            First Name
                          </th>
                          <th class="min-w-120px" (click)="OnSort('LastName')">
                            Last Name
                          </th>

                          <!-- Contact Details -->
                          <th
                            class="min-w-120px"
                            (click)="OnSort('PersonalMobile')"
                          >
                            Personal Mobile
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('WorkMobile')"
                          >
                            Work Mobile
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('OtherMobile')"
                          >
                            Other Mobile
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('PersonalPhone')"
                          >
                            Personal Phone
                          </th>
                          <th class="min-w-120px" (click)="OnSort('WorkPhone')">
                            Work Phone
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('OtherPhone')"
                          >
                            Other Phone
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('PersonalEmail')"
                          >
                            Personal Email
                          </th>
                          <th class="min-w-120px" (click)="OnSort('WorkEmail')">
                            Work Email
                          </th>
                          <th
                            class="min-w-120px"
                            (click)="OnSort('OtherEmail')"
                          >
                            Other Email
                          </th>
                          <!-- <th class="min-w-120px" (click)="OnSort('PersonalFax')"> Personal Fax </th>
                        <th class="min-w-120px" (click)="OnSort('WorkFax')"> Work Fax </th>
                        <th class="min-w-120px" (click)="OnSort('OtherFax')"> Other Fax </th> -->
                          
                          <th
                            class="min-w-120px"
                            (click)="OnSort('ContactType')"
                          >
                            Contact Type
                          </th>
                          <!-- <th class="min-w-120px" (click)="OnSort('Created')">
                            Created
                          </th>
                          <th class="min-w-120px" (click)="OnSort('CreatedBy')">
                            Created By
                          </th>
                          <th class="min-w-120px" (click)="OnSort('Updated')">
                            Updated
                          </th>
                          <th class="min-w-120px" (click)="OnSort('UpdatedBy')">
                            Updated By
                          </th> -->
                        </thead>
                        <!-- end::Table head -->

                        <!-- begin::Table Filter -->
                        <thead id="filter">
                          <!-- <form [formGroup]="searchContactForm"> -->
                          <th></th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterRef"
                              (keyup)="MinCharSearch($event, 'Ref')"
                            />
                          </th>
                          <th>
                            <ng-select style="margin-left: -8px;
                            width: 142px;"
                              formControlName="filterAssignee"
                              bindLabel="name"
                              (change)="filterContact()"
                            >
                              <!-- <ng-option value="" selected>Select Assign To</ng-option> -->
                              <ng-option
                                *ngFor="let assignee of assignToList"
                                [value]="assignee.id"
                                >
                                {{assignee.name}}
                                <!-- <span class="d-flex gap-2 align-items-center"
                                >
                                <ngx-avatar
                                  size="26"
                                  class="avatar"
                                  [name]="assignee?.name"
                                ></ngx-avatar>
                                {{ assignee.name }}</span> -->
                                </ng-option
                              >
                            </ng-select>
                          </th>

                          <th>
                            <ng-select
                              formControlName="filterTitle"
                              bindLabel="name"
                              id="titleId"
                              (change)="filterContact()"
                            >
                              <!-- <ng-option value="" selected>Select</ng-option> -->
                              <ng-option
                                *ngFor="let title of titleList"
                                [value]="title.id"
                                >{{ title.name }}</ng-option
                              >
                            </ng-select>
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterFirstName"
                              (keyup)="MinCharSearch($event, 'FirstName')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterLastName"
                              (keyup)="MinCharSearch($event, 'LastName')"
                            />
                          </th>

                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterPersonalMobile"
                              (keyup)="MinCharSearch($event, 'PersonalMobile')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterWorkMobile"
                              (keyup)="MinCharSearch($event, 'WorkMobile')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterOtherMobile"
                              (keyup)="MinCharSearch($event, 'OtherMobile')"
                            />
                          </th>

                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterPersonalPhone"
                              (keyup)="MinCharSearch($event, 'PersonalPhone')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterWorkPhone"
                              (keyup)="MinCharSearch($event, 'WorkPhone')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterOtherPhone"
                              (keyup)="MinCharSearch($event, 'OtherPhone')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterPersonalEmail"
                              (keyup)="MinCharSearch($event, 'PersonalEmail')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterWorkEmail"
                              (keyup)="MinCharSearch($event, 'WorkEmail')"
                            />
                          </th>
                          <th>
                            <input
                              type="text"
                              placeholder="Min. 3 chars"
                              class="form-control mb-3 mb-lg-0"
                              formControlName="filterOtherEmail"
                              (keyup)="MinCharSearch($event, 'OtherEmail')"
                            />
                          </th>
                          <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalFax" (keyup)="MinCharSearch($event,'PersonalFax')"/></th> -->
                          <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkFax" (keyup)="MinCharSearch($event,'WorkFax')"/></th> -->
                          <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterOtherFax" (keyup)="MinCharSearch($event,'OtherFax')"/></th> -->
                          
                          <th>
                            <ng-select
                              formControlName="filterContactType"
                              bindLabel="name"
                              id="titleId"
                              (change)="filterContact()"
                            >
                              <!-- <ng-option value="" selected>Select</ng-option> -->
                              <ng-option
                                *ngFor="let contactType of ContactTypeList"
                                [value]="contactType.id"
                                >{{ contactType.name }}</ng-option
                              >
                            </ng-select>
                          </th>
                          <!-- <th>
                            <div class="d-flex gap-2 w-200px">
                              <div class="position-relative w-50">
                                <input
                                  type="date"
                                  class="form-control mb-3 mb-lg-0"
                                  formControlName="filterCreatedFrom"
                                  (change)="filterContact()"
                                />
                                <span
                                  class="input-date-placeholder"
                                  for="filterCreatedFrom"
                                  >From</span
                                >
                              </div>
                              <div class="position-relative w-50">
                                <input
                                  type="date"
                                  class="form-control mb-3 mb-lg-0"
                                  formControlName="filterCreatedTo"
                                  (change)="filterContact()"
                                />
                                <span
                                  class="input-date-placeholder"
                                  for="filterCreatedTo"
                                  >To</span
                                >
                              </div>
                            </div>
                          </th>
                          <th>
                            <ng-select
                              formControlName="filterCreatedBy"
                              bindLabel="name"
                              id="titleId"
                              (change)="filterContact()"
                            >
                              <ng-option
                                *ngFor="let userData of userList"
                                [value]="userData.id"
                                >{{ userData.name }}</ng-option
                              >
                            </ng-select>
                          </th>
                          <th>
                            <div class="d-flex gap-2 w-200px">
                              <div class="position-relative w-50">
                                <input
                                  type="date"
                                  class="form-control mb-3 mb-lg-0"
                                  formControlName="filterUpdatedFrom"
                                  (change)="filterContact()"
                                />
                                <span
                                  class="input-date-placeholder"
                                  for="filterUpdatedFrom"
                                  >From</span
                                >
                              </div>
                              <div class="position-relative w-50">
                                <input
                                  type="date"
                                  class="form-control mb-3 mb-lg-0"
                                  formControlName="filterUpdatedTo"
                                  (change)="filterContact()"
                                />
                                <span
                                  class="input-date-placeholder"
                                  for="filterUpdatedTo"
                                  >To</span
                                >
                              </div>
                            </div>
                          </th>
                        <th>
                          <ng-select
                            formControlName="filterUpdatedBy"
                            bindLabel="name"
                            id="titleId"
                            (change)="filterContact()"
                          >
                            <ng-option
                              *ngFor="let userData of userList"
                              [value]="userData.id"
                              >{{ userData.name }}</ng-option
                            >
                          </ng-select>
                        </th> -->
                          <!-- </form> -->
                        </thead>

                        <!-- end::Table Filter -->

                        <!-- begin::Table Body -->
                        <tbody *ngIf="ContactDetailsList.length > 0">
                          <tr
                            *ngFor="
                              let data of ContactDetailsList
                                | paginate
                                  : {
                                      id: 'pagination_contact_tenant',
                                      itemsPerPage: pageSize,
                                      currentPage: pageNumber,
                                      totalItems: totalRecord
                                    }
                            "
                          >
                            <th class="w-40px align-middle">
                              <div
                                class="form-check form-check-sm form-check-custom form-check-solid p-0"
                              >
                                <input
                                  class="form-check-input cursor-pointer"
                                  type="radio"
                                  name="ContactOwner"
                                  [checked]="selectedListningTenantContactId == data?.id" 
                                  (click)="onSelectTenantContact(data?.id)"
                                  value="{{ data.Id }}"
                                  data-kt-check="true"
                                  data-kt-check-target=".widget-9-check"
                                />
                              </div>
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.ref }}
                            </th>
                            <th class="kt_contact-details_toggle">
                              <div class="d-flex gap-2 align-items-center">
                                <ngx-avatar *ngIf="data?.profileImage == null || data?.profileImage == ''" size="26" class="avatar" [name]="data?.agentName"></ngx-avatar>
                                <img *ngIf="data?.profileImage != null && data?.profileImage != ''" [src]="imgUrl + data?.profileImage" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="26" [style.height.px]="26">
                                <!-- <ngx-avatar
                                  size="26"
                                  class="avatar"
                                  [name]="data?.agentName"
                                ></ngx-avatar> -->
                                {{ data?.agentName }}
                              </div>
                            </th>
                            <!--Reference & Status-->
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.titleName }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.firstName }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.lastName }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getMobile(1, data?.mobile) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getMobile(2, data?.mobile) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getMobile(3, data?.mobile) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getPhone(1, data?.phone) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getPhone(2, data?.phone) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getPhone(3, data?.phone) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getEmail(1, data?.email) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getEmail(2, data?.email) }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ getEmail(3, data?.email) }}
                            </th>
                            <!-- <th>{{getFax(1,data?.fax)}}</th>
                          <th>{{getFax(2,data?.fax)}}</th>
                          <th>{{getFax(3,data?.fax)}}</th> -->
                            
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.contactTypeName }}
                            </th>
                            <!-- <th class="kt_contact-details_toggle align-middle">
                              {{ data?.created | date : "MM/dd/yyyy" }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.createdBy }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.updated | date : "MM/dd/yyyy" }}
                            </th>
                            <th class="kt_contact-details_toggle align-middle">
                              {{ data?.updatedBy }}
                            </th> -->
                          </tr>
                        </tbody>
                        <!-- end::Table Body -->
                      </table>
                      <div
                        class="text-center mt-5 mb-5"
                        *ngIf="
                        ContactDetailsList && ContactDetailsList?.length == 0
                        "
                      >
                        Record not available
                      </div>
                      <!-- end::Table -->
                    </div>
                  </div>
                  <div class="modal-footer py-3">
                    <div class="d-flex justify-content-between flex-column-reverse me-auto">
                      <pagination-controls *ngIf="ContactDetailsList.length > 0" (pageChange)="contactRenderPageBy($event)" id="pagination_contact_tenant"></pagination-controls>
                      <span class="d-block mb-3">Showing {{ ContactDetailsList.length }} of <b>{{totalRecord}}</b> Contacts</span>
                  </div>
        
                  <button (click)="contactDataTeantClose()" class="btn btn-sm btn-light btn-active-light-primary me-3">Cancel</button>
                  <button (click)="contactDataTeantSave()" [disabled]="tempSelectedTeantContactRef == null" class="btn btn-sm btn-primary" >Apply</button>
                  </div>
                </form>
              </div>
            </div>
          </ng-template>
          <div class="card-toolbar">
            <button
              type="button"
              class="btn btn-sm btn-icon btn-active-light-primary"
              id="kt_activities_close"
              (click)="closeActivities()"
            >
              <app-keenicon name="cross" class="fs-1"></app-keenicon>
            </button>
          </div>
        </div>

        <div class="d-flex align-items-center">
          <ul
            class="nav nav-stretch nav-line-tabs nav-line-tabs-2x border-transparent fs-5 fw-bold"
          >
            <!--begin::Nav item-->
            <li class="nav-item">
              <a
                class="nav-link text-active-primary ms-0 me-10 py-5 active cursor-pointer"
                [class.active]="selectedTab === 'tab1'"
                (click)="selectTab('tab1')"
              >
                Details
              </a>
            </li>

            <li class="nav-item">
              <a
                disabled="!isEdit"
                class="nav-link text-active-primary ms-0 me-10 py-5 cursor-pointer"
                [class.active]="selectedTab === 'tab2'"
                (click)="selectTab('tab2')"
              >
                Notes
              </a>
            </li>

            <li class="nav-item" >
              <a
                class="nav-link text-active-primary ms-0 me-10 py-5 cursor-pointer"
                [class.active]="selectedTab === 'tab3'"
                (click)="selectTab('tab3')"
              >
                Viewings
              </a>
            </li>
          </ul>

          <div class="d-flex align-items-center" *ngIf="selectedTab === 'tab1'">
            <button
              class="btn btn-sm btn-light-primary"
              *ngIf="!displayListing && isViewListingPermission"
              (click)="goToLink('/listings/view')"
            >
              <i class="bi bi-eye"></i> Preview Listing
            </button>
            <button
              (click)="onEditListing(); displayCancelBtn()"
              class="btn btn-sm btn-primary ms-3"
              *ngIf="!displayListing && isEditListingPermission"
            >
              Edit
            </button>
            <button
              (click)="onCancel()"
              class="btn btn-sm btn-light btn-active-light-primary me-3"
              *ngIf="displayListing && displayCancel"
            >
              Cancel
            </button>
            <button
              (click)="onSubmit()"
              class="btn btn-sm btn-primary"
              *ngIf="displayListing"
            >
              Save
            </button>
          </div>
        </div>
      </div>
      <!--./card-header-->

      <div class="card-body position-relative p-0" id="kt_activities_body">
        <!--Tab1-->

        <div *ngIf="selectedTab === 'tab1'">
          <ul class="accordian-shortcuts">
            <li id="sec_1_1">
              <button
                (click)="scrollToElement('secStatus'); basic = true"
                [ngClass]="
                  (submitted &&
                    f['assignedToId'].errors &&
                    (f['assignedToId'].dirty ||
                      f['assignedToId'].touched ||
                      f['assignedToId'].invalid)) ||
                  (submitted &&
                    f['usageId'].errors &&
                    (f['usageId'].dirty ||
                      f['usageId'].touched ||
                      f['usageId'].invalid)) ||
                  (submitted &&
                    f['purposeId'].errors &&
                    (f['purposeId'].dirty ||
                      f['purposeId'].touched ||
                      f['purposeId'].invalid)) ||
                  (submitted &&
                    f['propertyTypeId'].errors &&
                    (f['propertyTypeId'].dirty ||
                      f['propertyTypeId'].touched ||
                      f['propertyTypeId'].invalid)) ||
                  (submitted &&
                    f['parkingSpaces'].errors &&
                    (f['parkingSpaces'].dirty || f['parkingSpaces'].touched)) ||
                  (form.value.status === 1 &&
                    form.value.emiratesId === 1 &&
                    submitted &&
                    ((submitted &&
                      f['reraPermitNumber'].errors &&
                      (f['reraPermitNumber'].dirty ||
                        f['reraPermitNumber'].touched)) ||
                      f['reraPermitNumber'].invalid))
                    ? 'border-error'
                    : ''
                "
              >
                <i class="bi bi-house"></i>
              </button>
              <span class="reveal">Basic Details</span>
            </li>
            <li id="sec_2_1">
              <button
                (click)="scrollToElement('sec2'); address = true"
                [ngClass]="
                  (submitted &&
                    f['emiratesId'].errors &&
                    (f['emiratesId'].dirty ||
                      f['emiratesId'].touched ||
                      f['emiratesId'].invalid)) ||
                  (form.value.status == 1 &&
                    submitted &&
                    f['locationId'].errors &&
                    (f['locationId'].dirty ||
                      f['locationId'].touched ||
                      f['locationId'].invalid))
                    ? 'border-error '
                    : ''
                "
              >
                <i class="bi bi-geo-alt"></i>
              </button>
              <span class="reveal">Address</span>
            </li>
            <li id="sec_3_1">
              <button
                (click)="scrollToElement('sec3'); pricing = true"
                [ngClass]="
                  (submitted &&
                    f['price'].errors &&
                    (f['price'].dirty ||
                      f['price'].touched ||
                      f['price'].invalid)) ||
                  ((form.value.purposeId == 2 || previewData?.purposeId == 2) &&
                    submitted &&
                    f['frequencyId'].errors &&
                    (f['frequencyId'].dirty ||
                      f['frequencyId'].touched ||
                      f['frequencyId'].invalid))
                    ? 'border-error'
                    : ''
                "
              >
                <i class="bi bi-tag"></i>
              </button>
              <span class="reveal">Pricing</span>
            </li>
            <li id="sec_4_1">
              <button
                (click)="scrollToElement('sec4'); media = true"
                [ngClass]="
                  (form.value.status == 1 &&
                    submitted &&
                    f['title'].errors &&
                    (f['title'].dirty ||
                      f['title'].touched ||
                      f['title'].invalid)) ||
                  (form.value.status == 1 &&
                    submitted &&
                    f['description'].errors &&
                    (f['description'].dirty ||
                      f['description'].touched ||
                      f['description'].invalid))
                    ? 'border-error'
                    : ''
                "
              >
                <i class="bi bi-images"></i>
              </button>
              <span class="reveal">Marketing & Media</span>
            </li>

            <li id="sec_5_1">
              <button (click)="scrollToElement('sec5'); portal = true">
                <i class="bi bi-window-dock"></i>
              </button>
              <span class="reveal">Portals</span>
            </li>
            <li id="sec_6_1">
              <button (click)="scrollToElement('sec6'); feature = true">
                <i class="bi bi-star"></i>
              </button>
              <span class="reveal">Features & Amenities</span>
            </li>
            <li id="sec_7_1">
              <button (click)="scrollToElement('sec7'); neighbourhood = true">
                <i class="bi bi-map"></i>
              </button>
              <span class="reveal">Neighbourhood</span>
            </li>
            <li id="sec_8_1">
              <button (click)="scrollToElement('sec8'); contact = true">
                <i class="bi bi-person-vcard"></i>
              </button>
              <span class="reveal">Contact</span>
            </li>
            <li id="sec_9_1">
              <button (click)="scrollToElement('sec9'); additional = true">
                <i class="bi bi-list-task"></i>
              </button>
              <span class="reveal">Additonal Details</span>
            </li>
          </ul>
          <!--begin::Accordion-->

          <div class="accordion" id="kt_accordion_1">
            <div class="accordion-body border-bottom" id="secStatus">
              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6"
                  >Status</label
                >
                <div class="col-lg-6">
                  <ng-select
                    appendTo=".col-lg-6"
                    formControlName="status"
                    bindLabel="name"
                    [ngClass]="
                      form.value.status == 3
                        ? 'ph-status-dropdown text-blue'
                        : form.value.status == 1
                        ? 'ph-status-dropdown text-green'
                        : form.value.status == 2
                        ? 'ph-status-dropdown text-orange'
                        : ''
                    "
                    (change)="onChangeStatus($event)"
                    [clearable]="false"
                    [searchable]="false"
                  >
                    <ng-option
                      [ngClass]="
                        form.value.status == 3
                          ? 'text-blue'
                          : form.value.status == 1
                          ? 'text-green'
                          : 'text-orange'
                      "
                      [disabled]="disbledFields"
                      *ngFor="let car of statusList"
                      [value]="car.id"
                      >{{ car.name }}</ng-option
                    >
                  </ng-select>
                </div>
              </div>

              <div class="row">
                <label class="col-lg-3 col-form-label fw-bold fs-6"
                  >Availability</label
                >
                <div class="col-lg-6">
                  <ng-select
                    appendTo=".col-lg-6"
                    formControlName="propertyStatusId"
                    bindLabel="name"
                    (change)="onChangeDrp('propertyStatusId', $event)"
                  >
                    <ng-option
                      *ngFor="let car of propertyStatusList"
                      [value]="car.id"
                      >{{ car.name }}</ng-option
                    >
                  </ng-select>
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec1">
              <h2 class="accordion-header" id="kt_accordion_1_header_1">
                <button
                  type="button"
                  (click)="basic = !basic"
                  [class.collapsed]="!basic"
                  [ngClass]="
                    (submitted &&
                      f['assignedToId'].errors &&
                      (f['assignedToId'].dirty ||
                        f['assignedToId'].touched ||
                        f['assignedToId'].invalid)) ||
                    (submitted &&
                      f['usageId'].errors &&
                      (f['usageId'].dirty ||
                        f['usageId'].touched ||
                        f['usageId'].invalid)) ||
                    (submitted &&
                      f['purposeId'].errors &&
                      (f['purposeId'].dirty ||
                        f['purposeId'].touched ||
                        f['purposeId'].invalid)) ||
                    (submitted &&
                      f['propertyTypeId'].errors &&
                      (f['propertyTypeId'].dirty ||
                        f['propertyTypeId'].touched ||
                        f['propertyTypeId'].invalid)) ||
                    (submitted &&
                      f['parkingSpaces'].errors &&
                      (f['parkingSpaces'].dirty ||
                        f['parkingSpaces'].touched)) ||
                    (form.value.status === 1 &&
                      form.value.emiratesId === 1 &&
                      submitted &&
                      ((submitted &&
                        f['reraPermitNumber'].errors &&
                        (f['reraPermitNumber'].dirty ||
                          f['reraPermitNumber'].touched)) ||
                        f['reraPermitNumber'].invalid))
                      ? 'border-error accordion-button fs-4 fw-semibold'
                      : 'accordion-button fs-4 fw-semibold'
                  "
                >
                  Basic Details
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_1"
                class="accordion-collapse collapse"
                [class.show]="basic"
              >
                <div class="accordion-body">
                  <!--Basic Details-->
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label required fw-bold fs-6"
                      >Assigned To</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="assignedToId"
                        bindLabel="name"
                        id="assignedToId"
                        [class.border-error]="
                          submitted &&
                          f['assignedToId'].errors &&
                          (f['assignedToId'].dirty ||
                            f['assignedToId'].touched ||
                            f['assignedToId'].invalid)
                        "
                        [ngClass]="
                          submitted &&
                          f['assignedToId'].errors &&
                          (f['assignedToId'].dirty ||
                            f['assignedToId'].touched ||
                            f['assignedToId'].invalid)
                            ? 'border-error'
                            : ''
                        "
                      >
                      <ng-option *ngFor="let assignee of assignToList" [value]="assignee.id">
                        <span class="d-flex gap-2 align-items-center">
                          <ngx-avatar *ngIf="assignee.profileImage == null || assignee.profileImage == ''" size="26" class="avatar" [name]="assignee?.name"></ngx-avatar>
                          <img *ngIf="assignee.profileImage != null && assignee.profileImage != ''" [src]="assignee.profileImage" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="26" [style.height.px]="26">
                          {{ assignee.name }}</span></ng-option>
                       
                      </ng-select>
                      <div
                        *ngIf="
                          submitted &&
                          f['assignedToId'].errors &&
                          (f['assignedToId'].dirty ||
                            f['assignedToId'].touched ||
                            f['assignedToId'].invalid)
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">Assigned To is required</div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label required fw-bold fs-6"
                      >Usage</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="usageId"
                        bindLabel="name"
                        id="usageID"
                        [class.border-error]="
                          submitted &&
                          f['usageId'].errors &&
                          (f['usageId'].dirty ||
                            f['usageId'].touched ||
                            f['usageId'].invalid)
                        "
                        [ngClass]="
                          submitted &&
                          f['usageId'].errors &&
                          (f['usageId'].dirty ||
                            f['usageId'].touched ||
                            f['usageId'].invalid)
                            ? 'border-error'
                            : ''
                        "
                        (change)="onChangeUsage($event)"
                      >
                        <ng-option
                          *ngFor="let car of usageList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                      <div
                        *ngIf="
                          submitted &&
                          f['usageId'].errors &&
                          (f['usageId'].dirty ||
                            f['usageId'].touched ||
                            f['usageId'].invalid)
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">Usage is required</div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label required fw-bold fs-6"
                      >Purpose</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="purposeId"
                        bindLabel="name"
                        id="purposeID"
                        [class.border-error]="
                          submitted &&
                          f['purposeId'].errors &&
                          (f['purposeId'].dirty ||
                            f['purposeId'].touched ||
                            f['purposeId'].invalid)
                        "
                        [ngClass]="
                          submitted &&
                          f['purposeId'].errors &&
                          (f['purposeId'].dirty ||
                            f['purposeId'].touched ||
                            f['purposeId'].invalid)
                            ? 'border-error'
                            : ''
                        "
                        (change)="
                          onPurposeSelection($event);
                          onChangeDrp('purposeId', $event)
                        "
                      >
                        <ng-option
                          *ngFor="let car of purposeList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                      <div
                        *ngIf="
                          submitted &&
                          f['purposeId'].errors &&
                          (f['purposeId'].dirty ||
                            f['purposeId'].touched ||
                            f['purposeId'].invalid)
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">Purpose is required</div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label required fw-bold fs-6"
                      >Property Type</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="propertyTypeId"
                        bindLabel="name"
                        id="propertyTypeId"
                        [class.border-error]="
                          submitted &&
                          f['propertyTypeId'].errors &&
                          (f['propertyTypeId'].dirty ||
                            f['propertyTypeId'].touched ||
                            f['propertyTypeId'].invalid)
                        "
                        [ngClass]="
                          submitted &&
                          f['propertyTypeId'].errors &&
                          (f['propertyTypeId'].dirty ||
                            f['propertyTypeId'].touched ||
                            f['propertyTypeId'].invalid)
                            ? 'border-error'
                            : ''
                        "
                        (change)="onChangeDrp('propertyTypeId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of propertyTypeList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                      <div
                        *ngIf="
                          submitted &&
                          f['propertyTypeId'].errors &&
                          (f['propertyTypeId'].dirty ||
                            f['propertyTypeId'].touched ||
                            f['propertyTypeId'].invalid)
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">Property Type is required</div>
                      </div>
                    </div>
                  </div>

                  <div
                    class="row mb-6"
                    *ngIf="
                      form.value.purposeId == 1 || previewData?.purposeId == 1
                    "
                  >
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Completion Status</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="completionStatusId"
                        bindLabel="name"
                        id="completionStatusId"
                        (change)="onChangeDrp('completionStatusId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of ComplitionStatusList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Beds</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="bedsId"
                        bindLabel="name"
                        id="bedsId"
                        (change)="onChangeDrp('bedsId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of bedList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Baths</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="bathsId"
                        bindLabel="name"
                        id="bathsId"
                        (change)="onChangeDrp('bathsId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of bathsList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Built-up Area</label
                    >
                    <div class="col-lg-6">
                      <div class="input-group mb-5">
                        <span class="input-group-text" id="basic-addon1">
                          {{ companySettings?.measuringUnit == 'Square Feet'? 'Sq. Ft.':'Sq. M.' }}
                        </span>
                        <input
                          type="text"
                          id="buildUpArea"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="buildUpArea"
                          mask="0*.00"
                          [dropSpecialCharacters]="false"
                          (keyup)="changeFormula($event)"
                        />
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Plot Area</label
                    >
                    <div class="col-lg-6">
                      <div class="input-group mb-5">
                        <span class="input-group-text" id="basic-addon1">
                          {{ companySettings?.measuringUnit == 'Square Feet'? 'Sq. Ft.':'Sq. M.' }}
                        </span>
                        <input
                          formControlName="plotArea"
                          type="text"
                          id="plotArea"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          mask="0*.00"
                          [dropSpecialCharacters]="false"
                          [class.border-error]="
                            f['plotArea'].errors &&
                            (f['plotArea'].dirty || f['plotArea'].touched)
                          "
                        />
                      </div>
                      <div
                        *ngIf="
                          f['plotArea'].errors &&
                          (f['plotArea'].dirty || f['plotArea'].touched)
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">Plot Area is required</div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Furnished</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="furnishedId"
                        bindLabel="name"
                        id="furnishedId"
                        (change)="onChangeDrp('furnishedId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of furnishedList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>

                  <div class="row mb-6" *ngIf="form.value.usageId == 2">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Fitted</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="fittedId"
                        bindLabel="name"
                        id="fittedId"
                        (change)="onChangeDrp('fittedId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of fittedList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Parking Spaces</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="parkingSpaces"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="parkingSpaces"
                        (keypress)="isNumber($event)"
                        [class.border-error]="
                          submitted &&
                          f['parkingSpaces'].errors &&
                          (f['parkingSpaces'].dirty ||
                            f['parkingSpaces'].touched)
                        "
                      />
                      <div
                        *ngIf="
                          submitted &&
                          f['parkingSpaces'].errors &&
                          (f['parkingSpaces'].dirty ||
                            f['parkingSpaces'].touched)
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">Parking Space is required</div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >View</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="views"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="views"
                      />
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Layout Type</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="layoutType"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="layoutType"
                      />
                    </div>
                  </div>

                  <div
                    class="row mb-6"
                    *ngIf="
                      form.value.purposeId == 1 || previewData?.purposeId == 1
                    "
                  >
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Tenure</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="ownershipDuration"
                        bindLabel="name"
                        id="ownershipDuration"
                        (change)="onChangeDrp('ownershipDuration', $event)"
                      >
                        <ng-option value="Freehold" selected
                          >Freehold</ng-option
                        >
                        <ng-option value="Leasehold" selected
                          >Leasehold</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label
                      [ngClass]="
                        form.value.status === 1 && form.value.emiratesId === 1
                          ? 'col-lg-3 col-form-label required fw-bold fs-6'
                          : 'col-lg-3 col-form-label fw-bold fs-6'
                      "
                      >RERA Permit No.</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="reraPermitNumber"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="reraPermitNumber"
                        [class.border-error]="
                          form.value.status === 1 &&
                          form.value.emiratesId === 1 &&
                          submitted
                            ? (submitted &&
                                f['reraPermitNumber'].errors &&
                                (f['reraPermitNumber'].dirty ||
                                  f['reraPermitNumber'].touched)) ||
                              f['reraPermitNumber'].invalid
                            : ''
                        "
                      />
                      <div
                        *ngIf="
                          form.value.status === 1 &&
                          form.value.emiratesId === 1 &&
                          submitted
                            ? (submitted &&
                                f['reraPermitNumber'].errors &&
                                (f['reraPermitNumber'].dirty ||
                                  f['reraPermitNumber'].touched)) ||
                              f['reraPermitNumber'].invalid
                            : ''
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">
                          RERA Permit No. is required
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >RERA Transaction No.</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="reraTransactionNumber"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="reraTransactionNumber"
                      />
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Title Deed No.</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="titleDeedNumber"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="titleDeedNumber"
                      />
                    </div>
                  </div>
                  <!--./Basic Details--->
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec2">
              <h2 class="accordion-header" id="kt_accordion_1_header_2">
                <button
                  type="button"
                  (click)="address = !address"
                  [class.collapsed]="!address"
                  [ngClass]="
                    (submitted &&
                      f['emiratesId'].errors &&
                      (f['emiratesId'].dirty ||
                        f['emiratesId'].touched ||
                        f['emiratesId'].invalid)) ||
                    (form.value.status == 1 &&
                      submitted &&
                      f['locationId'].errors &&
                      (f['locationId'].dirty ||
                        f['locationId'].touched ||
                        f['locationId'].invalid))
                      ? 'border-error accordion-button fs-4 fw-semibold'
                      : 'accordion-button fs-4 fw-semibold'
                  "
                >
                  Address
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_2"
                class="accordion-collapse collapse"
                [class.show]="address"
              >
                <div class="accordion-body">
                  <!--Address Details-->
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label required fw-bold fs-6"
                      >Emirate</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="emiratesId"
                        bindLabel="name"
                        id="emiratesId"
                        (change)="
                          onChangeDrp('emiratesId', $event);
                          selectEmirates($event)
                        "
                        [class.border-error]="
                          submitted &&
                          f['emiratesId'].errors &&
                          (f['emiratesId'].dirty ||
                            f['emiratesId'].touched ||
                            f['emiratesId'].invalid)
                        "
                        [ngClass]="
                          submitted &&
                          f['emiratesId'].errors &&
                          (f['emiratesId'].dirty ||
                            f['emiratesId'].touched ||
                            f['emiratesId'].invalid)
                            ? 'border-error'
                            : ''
                        "
                      >
                        <ng-option
                          *ngFor="let car of emiratesList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                      <div
                        *ngIf="
                          submitted &&
                          f['emiratesId'].errors &&
                          (f['emiratesId'].dirty ||
                            f['emiratesId'].touched ||
                            f['emiratesId'].invalid)
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">Emirate is required</div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label
                      [ngClass]="
                        form.value.status == 1
                          ? 'col-lg-3 col-form-label required fw-bold fs-6'
                          : 'col-lg-3 col-form-label fw-bold fs-6'
                      "
                      >Location</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="locationId"
                        bindLabel="name"
                        id="locationId"
                        (change)="
                          onChangeDrp('locationId', $event);
                          selectSubLocation($event)
                        "
                        [class.border-error]="
                          form.value.status == 1 &&
                          submitted &&
                          f['locationId'].errors &&
                          (f['locationId'].dirty ||
                            f['locationId'].touched ||
                            f['locationId'].invalid)
                        "
                        [ngClass]="
                          form.value.status == 1 &&
                          submitted &&
                          f['locationId'].errors &&
                          (f['locationId'].dirty ||
                            f['locationId'].touched ||
                            f['locationId'].invalid)
                            ? 'border-error'
                            : ''
                        "
                      >
                        <ng-option
                          *ngFor="let car of locationList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                      <div
                        *ngIf="
                          form.value.status == 1 &&
                          submitted &&
                          f['locationId'].errors &&
                          (f['locationId'].dirty ||
                            f['locationId'].touched ||
                            f['locationId'].invalid)
                        "
                        class="invalid-feedback d-block"
                      >
                        <div class="error-text">Location is required</div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Sub Location</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="subLocationId"
                        bindLabel="name"
                        id="subLocationId"
                        (change)="onChangeDrp('subLocationId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of subLocationList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Street</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="street"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="street"
                      />
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Floor</label
                    >
                    <div class="col-lg-6">
                      <input
                      (keypress)="isNumber($event)"
                        type="text"
                        id="floor"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="floor"
                      />
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Unit No.</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="unitNumber"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="unitNumber"
                      />
                    </div>
                  </div>
                  <!--./Address Details--->
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec3">
              <h2 class="accordion-header" id="kt_accordion_1_header_3">
                <button
                  type="button"
                  (click)="pricing = !pricing"
                  [class.collapsed]="!pricing"
                  [ngClass]="
                    (submitted &&
                      f['price'].errors &&
                      (f['price'].dirty ||
                        f['price'].touched ||
                        f['price'].invalid)) ||
                    ((form.value.purposeId == 2 ||
                      previewData?.purposeId == 2) &&
                      submitted &&
                      f['frequencyId'].errors &&
                      (f['frequencyId'].dirty ||
                        f['frequencyId'].touched ||
                        f['frequencyId'].invalid))
                      ? 'border-error accordion-button fs-4 fw-semibold'
                      : 'accordion-button fs-4 fw-semibold'
                  "
                >
                  Pricing
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_3"
                class="accordion-collapse collapse"
                [class.show]="pricing"
              >
                <div class="accordion-body">
                  <!--Pricing-->
                  <div
                    class="row mb-6"
                    *ngIf="
                      form.value.purposeId == 2 || previewData?.purposeId == 2
                    "
                  >
                    <label class="col-lg-3 col-form-label required fw-bold fs-6"
                      >Frequency</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="frequencyId"
                        bindLabel="name"
                        id="frequencyId"
                        (change)="onChangeDrp('frequencyId', $event)"
                        [class.border-error]="
                          (form.value.purposeId == 2 ||
                            previewData?.purposeId == 2) &&
                          submitted &&
                          f['frequencyId'].errors &&
                          (f['frequencyId'].dirty ||
                            f['frequencyId'].touched ||
                            f['frequencyId'].invalid)
                        "
                        [ngClass]="
                          (form.value.purposeId == 2 ||
                            previewData?.purposeId == 2) &&
                          submitted &&
                          f['frequencyId'].errors &&
                          (f['frequencyId'].dirty ||
                            f['frequencyId'].touched ||
                            f['frequencyId'].invalid)
                            ? 'border-error'
                            : ''
                        "
                      >
                        <ng-option
                          *ngFor="let car of frequencyList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                      <div
                        *ngIf="
                          (form.value.purposeId == 2 ||
                            previewData?.purposeId == 2) &&
                          submitted &&
                          f['frequencyId'].errors
                        "
                        class="invalid-feedback d-block"
                      >
                        <div
                          class="error-text"
                          *ngIf="
                            (form.value.purposeId == 2 ||
                              previewData?.purposeId == 2) &&
                            submitted &&
                            f['frequencyId'].errors &&
                            (f['frequencyId'].dirty ||
                              f['frequencyId'].touched ||
                              f['frequencyId'].invalid)
                          "
                        >
                          Frequency is required
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    class="row mb-6"
                    *ngIf="
                      form.value.purposeId == 2 || previewData?.purposeId == 2
                    "
                  >
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Cheques</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="chequeId"
                        bindLabel="name"
                        id="chequeId"
                        (change)="onChangeDrp('chequeId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of chequeList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label required fw-bold fs-6"
                      >Price</label
                    >
                    <div class="col-lg-6">
                      <div class="input-group mb-5">
                        <span class="input-group-text" id="basic-addon1">
                          {{ companySettings?.currency }}
                        </span>
                        <input
                          type="text"
                          id="price"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="price"
                          mask="0*.00"
                          [dropSpecialCharacters]="false"
                          [class.border-error]="
                            submitted &&
                            f['price'].errors &&
                            (f['price'].dirty ||
                              f['price'].touched ||
                              f['price'].invalid)
                          "
                          (keyup)="changeFormula($event)"
                        />
                      </div>
                      <div
                        *ngIf="f['price'].errors"
                        class="invalid-feedback d-block"
                      >
                        <div
                          class="error-text"
                          *ngIf="
                            submitted &&
                            f['price'].errors &&
                            (f['price'].dirty ||
                              f['price'].touched ||
                              f['price'].invalid)
                          "
                        >
                          Price is required
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Price per Sq.Ft.</label
                    >
                    <div class="col-lg-6" aria-disabled="true">
                      <div class="input-group mb-5">
                        <span class="input-group-text" id="basic-addon1">
                          {{ companySettings?.currency }}
                        </span>
                        <input
                          type="text"
                          id="pricePerSqFt"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="pricePerSqFt"
                        />
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Commission</label
                    >
                    <div class="col-lg-3">
                      <!--begin::Input group-->
                      <div class="input-group mb-5">
                        <span
                          class="input-group-text"
                          id="basic-addon1"
                          style="width: 45px"
                        >
                          %
                        </span>
                        <input
                          type="text"
                          id="commisionPer"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="commisionPer"
                          mask="0*.00"
                          [dropSpecialCharacters]="false"
                          (keyup)="changeAEDFormula('commisionAED', $event)"
                          (change)="changeAEDFormula('commisionAED', $event)"
                        />
                      </div>
                      <!--end::Input group-->
                    </div>
                    <div class="col-lg-3">
                      <!--begin::Input group-->
                      <div class="input-group mb-5">
                        <span class="input-group-text" id="basic-addon1">
                          {{ companySettings?.currency }}
                        </span>
                        <input
                          type="text"
                          id="commisionAED"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="commisionAED"
                          mask="0*.00"
                          [dropSpecialCharacters]="false"
                          (keyup)="changePerFormula('commisionPer', $event)"
                          (change)="changePerFormula('commisionPer', $event)"
                        />
                      </div>
                      <!--end::Input group-->
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Deposit</label
                    >
                    <div class="col-lg-3">
                      <!--begin::Input group-->
                      <div class="input-group mb-5">
                        <span
                          class="input-group-text"
                          id="basic-addon1"
                          style="width: 45px"
                        >
                          %
                        </span>
                        <input
                          type="text"
                          id="depositPer"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="depositPer"
                          mask="0*.00"
                          [dropSpecialCharacters]="false"
                          (keyup)="changeAEDFormula('depositAED', $event)"
                          (change)="changeAEDFormula('depositAED', $event)"
                        />
                      </div>
                      <!--end::Input group-->
                    </div>
                    <div class="col-lg-3">
                      <!--begin::Input group-->
                      <div class="input-group mb-5">
                        <span class="input-group-text" id="basic-addon1">
                          {{ companySettings?.currency }}
                        </span>
                        <input
                          type="text"
                          id="depositAED"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="depositAED"
                          mask="0*.00"
                          [dropSpecialCharacters]="false"
                          (keyup)="changePerFormula('depositPer', $event)"
                          (change)="changePerFormula('depositPer', $event)"
                        />
                      </div>
                      <!--end::Input group-->
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Monthly Service Charges</label
                    >
                    <div class="col-lg-6">
                      <div class="input-group mb-5">
                        <span class="input-group-text" id="basic-addon1">
                          {{ companySettings?.currency }} </span
                        ><input
                          type="text"
                          id="monthlyServiceCharges"
                          class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="monthlyServiceCharges"
                          mask="0*.00"
                          [dropSpecialCharacters]="false"
                        />
                      </div>
                    </div>
                  </div>
                  <!--Pricing-->
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec4">
              <h2 class="accordion-header" id="kt_accordion_1_header_4">
                <button
                  type="button"
                  (click)="media = !media"
                  [class.collapsed]="!media"
                  [ngClass]="
                    (form.value.status == 1 &&
                      submitted &&
                      f['title'].errors &&
                      (f['title'].dirty ||
                        f['title'].touched ||
                        f['title'].invalid)) ||
                    (form.value.status == 1 &&
                      submitted &&
                      f['description'].errors &&
                      (f['description'].dirty ||
                        f['description'].touched ||
                        f['description'].invalid))
                      ? 'border-error accordion-button fs-4 fw-semibold'
                      : 'accordion-button fs-4 fw-semibold'
                  "
                >
                  Marketing & Media
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_4"
                class="accordion-collapse collapse"
                [class.show]="media"
              >
                <div class="accordion-body">
                  <!--Marketing & Media-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Language</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="languageId"
                        bindLabel="languageName"
                        id="languageId"
                        [clearable]="false"
                        [searchable]="false"
                        (change)="onChangeDrp('languageId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of LanguageList"
                          [value]="car.id"
                          >{{ car.languageName }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label
                      [ngClass]="
                        form.value.status == 1
                          ? 'col-lg-3 col-form-label required fw-bold fs-6'
                          : 'col-lg-3 col-form-label fw-bold fs-6'
                      "
                      >Title</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="title"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="title"
                        (keyup)="onTitleCount($event)"
                        [class.border-error]="
                          form.value.status == 1 &&
                          submitted &&
                          f['title'].errors &&
                          (f['title'].dirty ||
                            f['title'].touched ||
                            f['title'].invalid)
                        "
                      />{{ totalLengthTitle }} Characters
                      <div
                        *ngIf="f['title'].errors"
                        class="invalid-feedback d-block"
                      >
                        <div
                          class="error-text"
                          *ngIf="
                            f['title'].errors &&
                            (f['title'].dirty ||
                              f['title'].touched ||
                              f['title'].invalid)
                          "
                        >
                          Title is required
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label
                      [ngClass]="
                        form.value.status == 1
                          ? 'col-lg-3 col-form-label required fw-bold fs-6'
                          : 'col-lg-3 col-form-label fw-bold fs-6'
                      "
                      >Description</label
                    >
                    <div class="col-lg-6">
                      <textarea
                        type="textarea"
                        rows="3"
                        id="description"
                        class="form-control form-control-lg mb-3 mb-lg-0 textarea"
                        formControlName="description"
                        (keyup)="onDescriptionCount($event)"
                        [class.border-error]="
                          form.value.status == 1 &&
                          submitted &&
                          f['description'].errors &&
                          (f['description'].dirty ||
                            f['description'].touched ||
                            f['description'].invalid)
                        "
                      ></textarea
                      >{{ totalLengthDescription }} Characters,
                      {{ totalWordLengthDescription }} Words
                      <div
                        *ngIf="f['description'].errors"
                        class="invalid-feedback d-block"
                      >
                        <div
                          class="error-text"
                          *ngIf="
                            f['description'].errors &&
                            (f['description'].dirty ||
                              f['description'].touched ||
                              f['description'].invalid)
                          "
                        >
                          Description is required
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Photos</label
                    >
                    <div class="col-lg-6">
                      <ngx-dropzone-label
                        >Drag & Drop Images Here or Browse</ngx-dropzone-label
                      >

                      <!-- Old code -->
                     <ngx-dropzone
                      [disabled]="disbledFields"
                        [expandable]="true"
                        (change)="onSelectPhotos($event)" cdkDropList (cdkDropListDropped)="drop($event)"
                      >
                         <ngx-dropzone-image-preview cdkDrag
                          showPreviews
                          class="img-display-dropzone"
                          ngProjectAs="ngx-dropzone-preview"
                          *ngFor="let f of filesPhotos; let i = index"
                          [file]="f.file"
                          [removable]="true"
                          (removed)="onRemovePhotos(f,i)"
                        >
                          <ngx-dropzone-label    *ngIf="!disbledFields"
                            class="display-watermark-label"
                            (click)="preventDefault($event)"
                          >
                            <div
                              class="d-flex justify-content-between align-items-center"
                            >
                              <small>Watermark</small>
                              <div
                                class="form-check form-switch form-switch-sm form-check-custom form-check-solid w-40px justify-content-end"
                              >
                                <input
                                  class="form-check-input cursor-pointer"
                                  id="waterMarkDisplayPhoto"
                                  type="checkbox"
                                  [(ngModel)]="f.watermark"
                                  [ngModelOptions]="{ standalone: true }"
                                  name="waterMarkDisplayPhoto"
                                  (change)="onchangeWatermarkForPhoto($event)"
                                />
                              </div>
                            </div>
                          </ngx-dropzone-label>
                        </ngx-dropzone-image-preview>
                      </ngx-dropzone>

                      <!-- New code -->
                      <!-- <ngx-dropzone
                      [disabled]="disbledFields"
                        [expandable]="true"
                        (change)="onSelectPhotos($event)"
                      >

                      <ngx-sortable [items]="filesPhotos" [showHeader]="false" style="display: flex; width: 100%;" (dragStart)="onDragStartPhotos($event)" (dropped)="OnDroppedPhotos($event)" (listSorted)="onlistSortedPhotos($event)">
                        <ng-template let-item="item" let-i="index">
                            <div class="sortable-list-item">
                              <ngx-dropzone-image-preview
                              showPreviews
                              class="img-display-dropzone"
                              ngProjectAs="ngx-dropzone-preview"
                              [file]="$any(item.file)"
                              [removable]="true"
                              (removed)="onRemovePhotos(item,i)"
                            >
                              <ngx-dropzone-label    *ngIf="!disbledFields"
                                class="display-watermark-label"
                                (click)="preventDefault($event)"
                              >
                                <div
                                  class="d-flex justify-content-between align-items-center"
                                >
                                  <small>Watermark</small>
                                  <div
                                    class="form-check form-switch form-switch-sm form-check-custom form-check-solid w-40px justify-content-end"
                                  >
                                    <input
                                      class="form-check-input cursor-pointer"
                                      id="waterMarkDisplayPhoto"
                                      type="checkbox"
                                      [(ngModel)]="item.watermark"
                                      [ngModelOptions]="{ standalone: true }"
                                      name="waterMarkDisplayPhoto"
                                      (change)="onchangeWatermarkForPhoto($event)"
                                    />
                                  </div>
                                </div>
                              </ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                            </div>
                        </ng-template>
                    </ngx-sortable>
                        
                      </ngx-dropzone> -->
                      </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Floor Plans</label
                    >
                    <div class="col-lg-6">
                      <ngx-dropzone-label
                        >Drag & Drop Images Here or Browse</ngx-dropzone-label
                      >
                      <ngx-dropzone
                        [disabled]="disbledFields"
                        (change)="onSelectFloorPlan($event)"
                        [expandable]="true" cdkDropList (cdkDropListDropped)="dropFloorPlan($event)"
                      >
                        <ngx-dropzone-image-preview cdkDrag
                          class="img-display-dropzone"
                          ngProjectAs="ngx-dropzone-preview"
                          *ngFor="let f of filesFloorPlan;let i = index"
                          [file]="f.file"
                          [removable]="true"
                          (removed)="onRemoveFloorPlan(f,i)"
                        >
                          <ngx-dropzone-label   *ngIf="!disbledFields"
                            class="display-watermark-label"
                            (click)="preventDefault($event)"
                          >
                            <div
                              class="d-flex justify-content-between align-items-center"
                            >
                              <small>Watermark</small>
                              <div
                                class="form-check form-switch form-switch-sm form-check-custom form-check-solid w-40px justify-content-end"
                              >
                                <input
                                  class="form-check-input cursor-pointer"
                                  id="waterMarkDisplayFloorPlan"
                                  type="checkbox"
                                  [(ngModel)]="f.watermark"
                                  [ngModelOptions]="{ standalone: true }"
                                  name="waterMarkFloorPlan"
                                  (change)="
                                    onchangeWatermarkForFloorPlan($event)
                                  "
                                />
                              </div>
                            </div>
                          </ngx-dropzone-label>
                        </ngx-dropzone-image-preview>
                      </ngx-dropzone>

                      <!-- <ngx-dropzone
                      [disabled]="disbledFields"
                        [expandable]="true"
                        (change)="onSelectFloorPlan($event)"
                      >

                      <ngx-sortable [items]="filesFloorPlan" [showHeader]="false" style="display: flex; width: 100%;" (dragStart)="onDragStartFloorPlan($event)" (dropped)="OnDroppedFloorPlan($event)" (listSorted)="onlistSortedFloorPlan($event)">
                        <ng-template let-item="item" let-i="index">
                            <div class="sortable-list-item">
                              <ngx-dropzone-image-preview
                              showPreviews
                              class="img-display-dropzone"
                              ngProjectAs="ngx-dropzone-preview"
                              [file]="$any(item.file)"
                              [removable]="true"
                              (removed)="onRemoveFloorPlan(item,i)"
                            >
                              <ngx-dropzone-label    *ngIf="!disbledFields"
                                class="display-watermark-label"
                                (click)="preventDefault($event)"
                              >
                                <div
                                  class="d-flex justify-content-between align-items-center"
                                >
                                  <small>Watermark</small>
                                  <div
                                    class="form-check form-switch form-switch-sm form-check-custom form-check-solid w-40px justify-content-end"
                                  >
                                    <input
                                      class="form-check-input cursor-pointer"
                                      id="waterMarkDisplayFloorPlan"
                                      type="checkbox"
                                      [(ngModel)]="item.watermark"
                                      [ngModelOptions]="{ standalone: true }"
                                      name="waterMarkFloorPlan"
                                      (change)="onchangeWatermarkForFloorPlan($event)"
                                    />
                                  </div>
                                </div>
                              </ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                            </div>
                        </ng-template>
                    </ngx-sortable>
                        
                      </ngx-dropzone> -->
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Youtube Video Link
                    </label>
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="youtubeVideoLink"
                        formControlName="youtubeVideoLink"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >360 Virtual Tour Link</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="virtualTourLink"
                        formControlName="virtualTourLink"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Audio Tour Link</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="audioTourLink"
                        formControlName="audioTourLink"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Video Tour Link</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="videoTourLink"
                        formControlName="videoTourLink"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >QR Code Link</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="qrCodeLink"
                        formControlName="qrCodeLink"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >PDF Brochure
                    </label>
                    <div class="col-lg-6">
                      <ngx-dropzone-label
                        >Drag & Drop Files Here or Browse</ngx-dropzone-label
                      >
                      <ngx-dropzone
                        [disabled]="disbledFields"
                        (change)="onSelectPDFBrochure($event)"
                        [expandable]="true" cdkDropList (cdkDropListDropped)="dropPDFBrouchure($event)"
                      >
                        <ngx-dropzone-image-preview cdkDrag
                          class="img-display-dropzone"
                          ngProjectAs="ngx-dropzone-preview"
                          *ngFor="let f of filesPDFBrouchure;let i = index"
                          [file]="f.file"
                          [removable]="true"
                          (removed)="onRemovePDFBrochure(f,i)"
                        >
                          <ngx-dropzone-label *ngIf="!disbledFields"
                            class="display-watermark-label"
                            (click)="preventDefault($event)"
                          >
                            <div
                              class="d-flex justify-content-between align-items-center"
                            >
                              <small>Watermark</small>
                              <div
                                class="form-check form-switch form-switch-sm form-check-custom form-check-solid w-40px justify-content-end"
                              >
                                <input
                                  class="form-check-input cursor-pointer"
                                  id="waterMarkDisplayPDFBrochure"
                                  type="checkbox"
                                  [(ngModel)]="f.watermark"
                                  [ngModelOptions]="{ standalone: true }"
                                  name="waterMarkDisplayPDFBrochure"
                                  (change)="
                                    onchangeWatermarkForPDFBrochure($event)
                                  "
                                />
                              </div>
                            </div>
                          </ngx-dropzone-label>
                        </ngx-dropzone-image-preview>
                      </ngx-dropzone>

                      <!-- <ngx-dropzone
                      [disabled]="disbledFields"
                        [expandable]="true"
                        (change)="onSelectPDFBrochure($event)"
                      >

                      <ngx-sortable [items]="filesPDFBrouchure" [showHeader]="false" style="display: flex; width: 100%;" (dragStart)="onDragStartPDFBrochure($event)" (dropped)="OnDroppedPDFBrochure($event)" (listSorted)="onlistSortedPDFBrochure($event)">
                        <ng-template let-item="item" let-i="index">
                            <div class="sortable-list-item">
                              <ngx-dropzone-image-preview
                              showPreviews
                              class="img-display-dropzone"
                              ngProjectAs="ngx-dropzone-preview"
                              [file]="$any(item.file)"
                              [removable]="true"
                              (removed)="onRemovePDFBrochure(item,i)"
                            >
                              <ngx-dropzone-label    *ngIf="!disbledFields"
                                class="display-watermark-label"
                                (click)="preventDefault($event)"
                              >
                                <div
                                  class="d-flex justify-content-between align-items-center"
                                >
                                  <small>Watermark</small>
                                  <div
                                    class="form-check form-switch form-switch-sm form-check-custom form-check-solid w-40px justify-content-end"
                                  >
                                    <input
                                      class="form-check-input cursor-pointer"
                                      id="waterMarkDisplayPDFBrochure"
                                      type="checkbox"
                                      [(ngModel)]="item.watermark"
                                      [ngModelOptions]="{ standalone: true }"
                                      name="waterMarkDisplayPDFBrochure"
                                      (change)="onchangeWatermarkForPDFBrochure($event)"
                                    />
                                  </div>
                                </div>
                              </ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                            </div>
                        </ng-template>
                    </ngx-sortable>
                        
                      </ngx-dropzone> -->
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Upload Video</label
                    >
                    <div class="col-lg-6">
                      <ngx-dropzone-label
                        >Drag & Drop Videos Here or Browse</ngx-dropzone-label
                      >
                      <ngx-dropzone
                        [disabled]="disbledFields"
                        (change)="onSelectUploadVideo($event)"
                        [expandable]="true" cdkDropList (cdkDropListDropped)="dropUploadVideo($event)"
                      >
                        <ngx-dropzone-video-preview cdkDrag
                          class="img-display-dropzone"
                          ngProjectAs="ngx-dropzone-preview"
                          *ngFor="let f of filesUploadVideo;let i = index"
                          [file]="f.file"
                          [removable]="true"
                          (removed)="onRemoveUploadVideo(f,i)"
                        >
                          <ngx-dropzone-label *ngIf="!disbledFields"
                            class="display-watermark-label"
                            (click)="preventDefault($event)"
                          >
                            <div
                              class="d-flex justify-content-between align-items-center"
                            >
                              <small>Watermark</small>
                              <div
                                class="form-check form-switch form-switch-sm form-check-custom form-check-solid w-40px justify-content-end"
                              >
                                <input
                                  class="form-check-input cursor-pointer"
                                  id="waterMarkDisplayVideo"
                                  type="checkbox"
                                  [(ngModel)]="f.watermark"
                                  [ngModelOptions]="{ standalone: true }"
                                  name="waterMarkDisplayVideo"
                                  (change)="onchangeWatermarkForVideo($event)"
                                />
                              </div>
                            </div>
                          </ngx-dropzone-label>
                        </ngx-dropzone-video-preview>
                      </ngx-dropzone>

                      <!-- <ngx-dropzone
                      [disabled]="disbledFields"
                        [expandable]="true"
                        (change)="onSelectUploadVideo($event)"
                      >

                      <ngx-sortable [items]="filesUploadVideo" [showHeader]="false" style="display: flex; width: 100%;" (dragStart)="onDragStartVideos($event)" (dropped)="OnDroppedVideos($event)" (listSorted)="onlistSortedVideos($event)">
                        <ng-template let-item="item" let-i="index">
                            <div class="sortable-list-item">
                              <ngx-dropzone-image-preview
                              showPreviews
                              class="img-display-dropzone"
                              ngProjectAs="ngx-dropzone-preview"
                              [file]="$any(item.file)"
                              [removable]="true"
                              (removed)="onRemoveUploadVideo(item,i)"
                            >
                              <ngx-dropzone-label    *ngIf="!disbledFields"
                                class="display-watermark-label"
                                (click)="preventDefault($event)"
                              >
                                <div
                                  class="d-flex justify-content-between align-items-center"
                                >
                                  <small>Watermark</small>
                                  <div
                                    class="form-check form-switch form-switch-sm form-check-custom form-check-solid w-40px justify-content-end"
                                  >
                                    <input
                                      class="form-check-input cursor-pointer"
                                      id="waterMarkDisplayVideo"
                                      type="checkbox"
                                      [(ngModel)]="item.watermark"
                                      [ngModelOptions]="{ standalone: true }"
                                      name="waterMarkDisplayVideo"
                                      (change)="onchangeWatermarkForVideo($event)"
                                    />
                                  </div>
                                </div>
                              </ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                            </div>
                        </ng-template>
                    </ngx-sortable>
                        
                      </ngx-dropzone> -->
                    </div>
                  </div>
                  <!--Marketing & Media-->
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec5">
              <h2 class="accordion-header" id="kt_accordion_1_header_5">
                <button
                  class="accordion-button fs-4 fw-semibold collapsed"
                  type="button"
                  (click)="portal = !portal"
                  [class.collapsed]="!portal"
                >
                  Portals
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_5"
                class="accordion-collapse collapse"
                [class.show]="portal"
              >
                <div class="accordion-body">
                  <!--Pricing-->
                  <div class="row" *ngIf="portalList.length > 0">
                    <div class="col-lg-4 mb-2" *ngFor="let cat of portalList">
                      <div class="form-check">
                        <input
                          [ngModelOptions]="{ standalone: true }"
                          [ngClass]="disbledFields ? 'disabled-checkbox' : ''"
                          id="portals"
                          class="form-check-input cursor-pointer"
                          type="checkbox"
                          [(ngModel)]="cat.checked"
                          [defaultChecked]="cat.checked"
                          value="{{ cat.id }}"
                          (change)="onChangePortals($event, cat)"
                        />
                        <label
                          class="form-check-label text-gray-700 fw-bold"
                          for="{{ cat.id }}"
                        >
                          {{ cat.name }}
                        </label>
                      </div>
                    </div>
                  </div>
                  <!--Pricing-->
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec6">
              <h2 class="accordion-header" id="kt_accordion_1_header_6">
                <button
                  class="accordion-button fs-4 fw-semibold collapsed"
                  type="button"
                  (click)="feature = !feature"
                  [class.collapsed]="!feature"
                >
                  Features
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_6"
                class="accordion-collapse collapse"
                [class.show]="feature"
              >
                <div class="accordion-body">
                  <!--Features-->
                  <div class="row">
                    <p class="bold">Property Features</p>
                    <div
                      class="col-lg-4 mb-2"
                      *ngFor="let cat of featuresListFeatures"
                    >
                      <div class="form-check">
                        <input
                          id="features"
                          [ngModelOptions]="{ standalone: true }"
                          [ngClass]="disbledFields ? 'disabled-checkbox' : ''"
                          [(ngModel)]="cat.checked"
                          [defaultChecked]="cat.checked"
                          value="{{ cat.id }}"
                          class="form-check-input cursor-pointer"
                          type="checkbox"
                          (change)="onChangeFeatures($event, cat)"
                        />
                        <label
                          class="form-check-label text-gray-700 fw-bold"
                          for="{{ cat.id }}"
                        >
                          {{ cat.name }}
                        </label>
                      </div>
                    </div>
                    <p class="bold">Property Amenities</p>
                    <div
                      class="col-lg-4 mb-2"
                      *ngFor="let cat of featuresListAmenities"
                    >
                      <div class="form-check">
                        <input
                          id="features"
                          [ngModelOptions]="{ standalone: true }"
                          [ngClass]="disbledFields ? 'disabled-checkbox' : ''"
                          [(ngModel)]="cat.checked"
                          [defaultChecked]="cat.checked"
                          value="{{ cat.id }}"
                          class="form-check-input cursor-pointer"
                          type="checkbox"
                          (change)="onChangeFeaturesAmenitied($event, cat)"
                        />
                        <label
                          class="form-check-label text-gray-700 fw-bold"
                          for="{{ cat.id }}"
                        >
                          {{ cat.name }}
                        </label>
                      </div>
                    </div>
                  </div>
                  <!--Features-->
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec7">
              <h2 class="accordion-header" id="kt_accordion_1_header_7">
                <button
                  class="accordion-button fs-4 fw-semibold collapsed"
                  type="button"
                  (click)="neighbourhood = !neighbourhood"
                  [class.collapsed]="!neighbourhood"
                >
                  Neighbourhood
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_7"
                class="accordion-collapse collapse"
                [class.show]="neighbourhood"
              >
                <div class="accordion-body">
                  <!--Pricing-->
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >School</label
                    >
                    <div class="col-lg-6">
                      <input
                        id="school"
                        formControlName="school"
                        type="text"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Metro</label
                    >
                    <div class="col-lg-6">
                      <input
                        id="metro"
                        formControlName="metro"
                        type="text"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Medical Center</label
                    >
                    <div class="col-lg-6">
                      <input
                        id="medicalCenter"
                        formControlName="medicalCenter"
                        type="text"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Shopping Mall</label
                    >
                    <div class="col-lg-6">
                      <input
                        id="shoppingMall"
                        formControlName="shoppingMall"
                        type="text"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Mosques</label
                    >
                    <div class="col-lg-6">
                      <input
                        id="mosques"
                        formControlName="mosques"
                        type="text"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Beach</label
                    >
                    <div class="col-lg-6">
                      <input
                        id="beach"
                        formControlName="beach"
                        type="text"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Super Market</label
                    >
                    <div class="col-lg-6">
                      <input
                        id="superMarket"
                        formControlName="superMarket"
                        type="text"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Park</label
                    >
                    <div class="col-lg-6">
                      <input
                        id="park"
                        formControlName="park"
                        type="text"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                      />
                    </div>
                  </div>
                  <!--Pricing-->
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec8">
              <h2 class="accordion-header" id="kt_accordion_1_header_8">
                <button
                  type="button"
                  (click)="contact = !contact"
                  [class.collapsed]="!contact"
                  class="accordion-button fs-4 fw-semibold"
                >
                  Contact
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_8"
                class="accordion-collapse collapse"
                [class.show]="contact"
              >
                <div class="accordion-body">
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Owner Contact</label
                    >
                    <div class="col-lg-6">
                      <div class="m-0">
                        <button [disabled]="isContact"
                          (click)="AddContact()"
                          class="btn btn-bg-light btn-icon-primary btn-text-primary"
                        >
                          <i class="bi bi-check2-square"></i> Select Contact
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- <div *ngIf="getContactsDetail">
                          <p>{{getContactsDetail?.firstName}} {{getContactsDetail?.lastName}}</p>
                          <p>{{getContactsDetail?.ref}}</p>
                          <hr/>
                          <p *ngFor="let mobile of getContactsDetail?.mobile">Mobile: {{mobile.countryCodeString}}{{mobile.mobile}}</p>

                          <p *ngFor="let mobile of getContactsDetail?.phone">Phone: {{mobile.countryCodeString}}{{mobile.phone}}</p>

                          <p *ngFor="let mobile of getContactsDetail?.email">Email: {{mobile.email}}</p>
                      </div> -->

                  <!--Owner Contact Deatils-->
                  <div *ngIf="getContactsDetail">
                    <div class="row mb-6">
                      <label class="col-lg-3 col-form-label fw-bold fs-6"
                        >Name</label
                      >
                      <div class="col-lg-6 d-flex align-items-center">
                        {{ getContactsDetail?.firstName }}
                        {{ getContactsDetail?.lastName }}
                      </div>
                    </div>
                    <!--./row-->
                    <div class="row mb-6">
                      <label class="col-lg-3 col-form-label fw-bold fs-6"
                        >Reference Number</label
                      >
                      <div class="col-lg-6 d-flex align-items-center">
                        {{ getContactsDetail?.ref }}
                      </div>
                    </div>
                    <!--./row-->
                    <carousel class="ph-carousel" id="ownerContact">
                      <slide>
                        <!-- Slide 1 content -->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Mobile (Personal)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                             getMobile(1,getContactsDetail?.mobile)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Phone (Personal)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                             getPhone(1,getContactsDetail?.phone)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Email (Personal)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getEmail(1,getContactsDetail?.email)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                      </slide>
                      <slide>
                        <!-- Slide 2 content -->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Mobile (Work)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getMobile(2,getContactsDetail?.mobile)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Phone (Work)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getPhone(2,getContactsDetail?.phone)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Email (Work)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getEmail(2,getContactsDetail?.email)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                      </slide>
                      <slide>
                        <!-- Slide 3 content -->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Mobile (Other)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getMobile(3,getContactsDetail?.mobile)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Phone (Other)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getPhone(3,getContactsDetail?.phone)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Email (Other)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getEmail(3,getContactsDetail?.email)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                      </slide>
                    </carousel>
                  </div>
                  <!--./Owner Contact Details-->

                  <hr />

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Tenant Contact</label
                    >
                    <div class="col-lg-6">
                      <div class="m-0">
                        <button [disabled]="isContact"
                          (click)="AddTenantContact()"
                          class="btn btn-bg-light btn-icon-primary btn-text-primary"
                        >
                          <i class="bi bi-check2-square"></i> Select Contact
                      </button>
                      </div>
                    </div>
                  </div>

                  <div *ngIf="getTenantContactsDetail">
                    <div class="row mb-6">
                      <label class="col-lg-3 col-form-label fw-bold fs-6"
                        >Name</label
                      >
                      <div class="col-lg-6 d-flex align-items-center">
                        {{ getTenantContactsDetail?.firstName }}
                        {{ getTenantContactsDetail?.lastName }}
                      </div>
                    </div>
                    <!--./row-->
                    <div class="row mb-6">
                      <label class="col-lg-3 col-form-label fw-bold fs-6"
                        >Reference Number</label
                      >
                      <div class="col-lg-6 d-flex align-items-center">
                        {{ getTenantContactsDetail?.ref }}
                      </div>
                    </div>
                    <!--./row-->
                    <carousel class="ph-carousel" id="tenantOwner">
                      <slide>
                        <!-- Slide 1 content -->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Mobile (Personal)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getMobile(1,getTenantContactsDetail?.mobile)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Phone (Personal)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getPhone(1,getTenantContactsDetail?.phone)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Email (Personal)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getEmail(1,getTenantContactsDetail?.email)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                      </slide>
                      <slide>
                        <!-- Slide 2 content -->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Mobile (Work)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getMobile(2,getTenantContactsDetail?.mobile)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Phone (Work)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getPhone(2,getTenantContactsDetail?.phone)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Email (Work)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getEmail(2,getTenantContactsDetail?.email)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                      </slide>
                      <slide>
                        <!-- Slide 3 content -->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Mobile (Other)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getMobile(3,getTenantContactsDetail?.mobile)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Phone (Other)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getPhone(3,getTenantContactsDetail?.phone)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                        <div class="row mb-6">
                          <label class="col-lg-3 col-form-label fw-bold fs-6"
                            >Email (Other)</label
                          >
                          <div class="col-lg-6 d-flex align-items-center">
                            {{
                              getEmail(3,getTenantContactsDetail?.email)
                            }}
                          </div>
                        </div>
                        <!--./row-->
                      </slide>
                    </carousel>
                  </div>
                  <!--Pricing-->
                </div>
              </div>
            </div>

            <div class="accordion-item" id="sec9">
              <h2 class="accordion-header" id="kt_accordion_1_header_9">
                <button
                  class="accordion-button fs-4 fw-semibold collapsed"
                  type="button"
                  (click)="additional = !additional"
                  [class.collapsed]="!additional"
                >
                  Additional Details
                </button>
              </h2>
              <div
                id="kt_accordion_1_body_9"
                class="accordion-collapse collapse"
                [class.show]="additional"
              >
                <div class="accordion-body">
                  <!--Pricing-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Source Of Listing</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="sourceOfListingId"
                        bindLabel="name"
                        (change)="onChangeDrp('sourceOfListingId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of sourceOfListingList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Expiration Date</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="date"
                        placeholder=""
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        id="expirationDate"
                        formControlName="expirationDate"
                      />
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Featured</label
                    >
                    <div class="col-lg-6 d-flex align-items-center">
                      <div style="width: 40px !important">
                        <div
                          class="form-check form-switch form-switch-sm form-check-custom form-check-solid"
                        >
                          <input
                            class="form-check-input cursor-pointer"
                            type="checkbox"
                            formControlName="featured"
                            name="notifications"
                            defaultChecked="{true}"
                            style="min-width: 40px !important"
                            (change)="onSwitchChange('featured', $event)"
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Managed</label
                    >
                    <div class="col-lg-6 d-flex align-items-center">
                      <div style="width: 40px !important">
                        <div
                          class="form-check form-switch form-switch-sm form-check-custom form-check-solid"
                        >
                          <input
                            class="form-check-input cursor-pointer"
                            type="checkbox"
                            formControlName="managed"
                            name="notifications"
                            defaultChecked="{true}"
                            style="min-width: 40px !important"
                            (change)="onSwitchChange('managed', $event)"
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Exclusive</label
                    >
                    <div class="col-lg-6 d-flex align-items-center">
                      <div style="width: 40px !important">
                        <div
                          class="form-check form-switch form-switch-sm form-check-custom form-check-solid"
                        >
                          <input
                            class="form-check-input cursor-pointer"
                            type="checkbox"
                            formControlName="exclusive"
                            name="notifications"
                            defaultChecked="{true}"
                            style="min-width: 40px !important"
                            (change)="onSwitchChange('exclusive', $event)"
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >DEWA No.</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="dEWANumber"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="dEWANumber"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >STR No.</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="test"
                        id="sTrNumber"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="sTrNumber"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Next Available</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="date"
                        placeholder=""
                        id="nextAvailable"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="nextAvailable"
                      />
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Remind</label
                    >
                    <div class="col-lg-6">
                      <ng-select
                        appendTo=".col-lg-6"
                        formControlName="remindId"
                        bindLabel="name"
                        (change)="onChangeDrp('remindId', $event)"
                      >
                        <ng-option
                          *ngFor="let car of remindList"
                          [value]="car.id"
                          >{{ car.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Key Location</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="text"
                        id="keyLocation"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="keyLocation"
                      />
                    </div>
                  </div>

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Property Tenanted</label
                    >
                    <div class="col-lg-6 d-flex align-items-center">
                      <div style="width: 40px !important">
                        <div
                          class="form-check form-switch form-switch-sm form-check-custom form-check-solid"
                        >
                          <input
                            class="form-check-input cursor-pointer"
                            type="checkbox"
                            formControlName="propertyTenanted"
                            name="notifications"
                            defaultChecked="{true}"
                            style="min-width: 40px !important"
                            (change)="
                              onSwitchChange('propertyTenanted', $event)
                            "
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Rented At</label
                    >
                    <div class="col-lg-6">
                      <div class="input-group mb-5">
                        <span class="input-group-text" id="basic-addon1">
                          {{ companySettings?.currency }}
                        </span>
                        <input
                        type="text"
                        placeholder=""
                        mask="0*.00"
                        [dropSpecialCharacters]="false"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="rentedAt"
                      />
                      </div>
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6"
                      >Rented Until</label
                    >
                    <div class="col-lg-6">
                      <input
                        type="date"
                        placeholder=""
                        id="rentedUntil"
                        class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="rentedUntil"
                      />
                    </div>
                  </div>
                  <!--Pricing-->
                </div>
              </div>
            </div>
            <!--end::Accordion-->
          </div>
          <!--./Tab1-->
        </div>
        <!--Tab2-->
        <div *ngIf="selectedTab === 'tab2'">
          <!--Notes-->
          <app-listing-notes-add
            [notesHidden]="isEdit"
            [listingId]="
              form.value.listingId != ''
                ? displayListingId
                : form.value.listingId
            "
          ></app-listing-notes-add>

          <!--Notes-->
        </div>

        <!--./Tab2-->

        <!--Tab3-->
        <div class="p-10" *ngIf="selectedTab === 'tab3'">
          <div id="edit-viewing-tab"></div>
          <div *ngIf="isEdit">
            <a
              *ngIf="addViewingButton"
              (click)="onViewingAdd()"
              class="kt_activities_toggle btn btn-sm btn-flex btn-primary fw-bold me-1"
            >
              <i class="bi bi-plus fs-2"></i> Add Viewing
            </a>
          </div>
          <div *ngIf="isEdit">
            <form [formGroup]="Viewings" *ngIf="viewingDataForm">
              <div>
                <div class="row mb-6">
                  <label class="col-lg-3 col-form-label fw-bold fs-6"
                    >Status</label
                  >
                  <div class="col-lg-6">
                    <div>
                      <ng-select
                        formControlName="statusId"
                        bindLabel="name"
                        (change)="onChangeViewingStatus($event)"
                        [clearable]="false"
                        [ngClass]="
                          Viewings.get('statusId')?.value == 1
                            ? 'ph-status-dropdown text-blue'
                            : Viewings.get('statusId')?.value == 2
                            ? 'ph-status-dropdown text-green'
                            : Viewings.get('statusId')?.value == 3
                            ? 'ph-status-dropdown text-red'
                            : Viewings.get('statusId')?.value == 4
                            ? 'ph-status-dropdown text-grey'
                            : ''
                        "
                      >
                        <ng-option
                          *ngFor="let vs of allViewingStatusList"
                          [value]="vs.id"
                          >{{ vs.name }}</ng-option
                        >
                      </ng-select>

                      <div
                        *ngIf="isViewingSubmitted && fv['statusId'].errors"
                        class="invalid-feedback d-block"
                      >
                        <div
                          class="error-text"
                          *ngIf="
                            isViewingSubmitted &&
                            fv['statusId'].errors &&
                            (fv['statusId'].dirty ||
                              fv['statusId'].touched ||
                              fv['statusId'].invalid)
                          "
                        >
                          Status is required
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row mb-6">
                  <label
                    style="margin-left: -37px; padding-inline: 46px"
                    class="col-lg-3 col-form-label fw-bold fs-6 required"
                    >Assigned To</label
                  >
                  <div class="col-lg-6" id="viewingSec1">
                    <ng-select
                      [ngClass]="
                        isViewingSubmitted &&
                        fv['agentId'].errors &&
                        (fv['agentId'].dirty ||
                          fv['agentId'].touched ||
                          fv['agentId'].invalid)
                          ? 'border-error'
                          : ''
                      "
                      style="margin-left: 36px; width: 394px"
                      appendTo=".col-lg-6"
                      formControlName="agentId"
                      bindLabel="agent"
                      [clearable]="false"
                    >
                    <ng-option *ngFor="let assignee of AgentLeadList" [value]="assignee.id">
                      <span class="d-flex gap-2 align-items-center">
                        <ngx-avatar *ngIf="assignee.profileImage == null || assignee.profileImage == ''" size="26" class="avatar" [name]="assignee?.name"></ngx-avatar>
                        <img *ngIf="assignee.profileImage != null && assignee.profileImage != ''" [src]="assignee.profileImage" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="26" [style.height.px]="26">
                        {{ assignee.name }}</span></ng-option>
                      
                    </ng-select>
                    <div
                      *ngIf="
                        isViewingSubmitted &&
                        fv['agentId'].errors &&
                        (fv['agentId'].dirty ||
                          fv['agentId'].touched ||
                          fv['agentId'].invalid)
                      "
                      class="invalid-feedback d-block"
                    >
                      <div class="error-text" style="padding-left: 37px">
                        Assigned To is required
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row mb-6">
                  <label class="col-lg-3 col-form-label fw-bold fs-6 required"
                    >Lead</label
                  >
                  <div class="col-lg-6">
                    <div>
                      <div class="m-0">
                        <a
                          [ngClass]="
                            isViewingSubmitted &&
                            !getLeadUsingId &&
                            getLeadUsingId == null
                              ? 'border-error btn btn-bg-light btn-icon-primary btn-text-primary'
                              : 'btn btn-bg-light btn-icon-primary btn-text-primary'
                          "
                          (click)="openViewingLead()"
                        >
                          <i class="bi bi-check2-square"></i> Select lead
                        </a>
                      </div>
                    </div>
                    <div
                      *ngIf="
                        isViewingSubmitted &&
                        !getLeadUsingId &&
                        getLeadUsingId == null"
                      class="invalid-feedback d-block"
                    >
                      <div
                        class="error-text"
                        *ngIf="!getLeadUsingId && getLeadUsingId == null"
                      >
                        Lead is required
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngIf="getLeadUsingId && getLeadUsingId != null">
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">
                      Lead Reference:
                    </label>
                    <div class="col-lg-3 d-flex align-items-center">
                      {{
                        getLeadUsingId.reference ||
                        getLeadUsingId.leadReference
                      }}
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">
                      Lead First Name:
                    </label>
                    <div class="col-lg-3 d-flex align-items-center">
                      {{
                        getLeadUsingId.firstName ||
                        getLeadUsingId.leadFirstName
                      }}
                    </div>
                  </div>
                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">
                      Lead Last Name:
                    </label>
                    <div class="col-lg-3 d-flex align-items-center">
                      {{
                        getLeadUsingId.lastName ||
                        getLeadUsingId.leadLastName
                      }}
                    </div>
                  </div>
                  <carousel class="ph-carousel mb-2" id="LeadViewingContact">
                    <slide>
                      <!-- Slide 1 content -->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Mobile (Personal)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{PeronsalMobile}}
                        </div>
                      </div><!--./row-->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Phone (Personal)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{PersonalPhone}}
                        </div>
                      </div><!--./row-->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Email (Personal)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{PersonalEmail}}
                        </div>
                      </div>
                      <!--./row-->
                    </slide>
                    <slide>
                      <!-- Slide 2 content -->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Mobile (Work)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{WorkMobile}}
                        </div>
                      </div><!--./row-->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Phone (Work)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{WorkPhone}}
                        </div>
                      </div><!--./row-->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Email (Work)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{WorkEmail}}
                        </div>
                      </div><!--./row-->
                    </slide>
                    <slide>
                      <!-- Slide 3 content -->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Mobile (Other)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{OtherMobile}}
                        </div>
                      </div><!--./row-->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Phone (Other)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{OtherPhone}}
                        </div>
                      </div><!--./row-->
                      <div class="row mb-6">
                        <label class="col-lg-3 col-form-label fw-bold fs-6">Email (Other)</label>
                        <div class="col-lg-6 d-flex align-items-center">
                          {{OtherEmail}}
                        </div>
                      </div><!--./row-->
                    </slide>
                  </carousel>
                </div>
                <ng-template #ViewListing>
                  <div
                    class="modal-content advance-filter-modal"
                    style="width: 90rem; position: relative; right: 14rem"
                  >
                    <div class="modal-header py-3">
                      <!--begin::Modal title-->
                      <h4 class="m-0">Select Lead</h4>
                      <!--end::Modal title-->
                      <div
                        class="btn btn-sm btn-icon btn-active-color-primary"
                        (click)="closeLeadist()"
                      >
                        <i class="ki-duotone ki-cross fs-1"
                          ><span class="path1"></span><span class="path2"></span
                        ></i>
                      </div>
                    </div>
                    <form
                      [formGroup]="ContactBasicForm"
                      novalidate=""
                      class="form"
                    >
                      <div
                        class="card-header align-items-center p-0 gap-2 gap-md-5"
                      >
                        <div class="table-responsive">
                          <!-- begin::Table -->
                          <div class="table-responsive" style="padding: 0 5px !important;">
                            <!-- begin::Table -->
                            <table
                              id="listings_row"
                              class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4"
                            >
                              <!-- begin::Table head -->
                              <thead class="fw-bold">
                                <th class="w-40px">

                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'Ref',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Reference
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'Status',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Status
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'SubStatus',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Sub Status
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'Agent',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Assigned To
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'FirstName',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  First Name
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'LastName',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Last Name
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'personalMobile',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Personal Mobile
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'workMobile',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Work Mobile
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'otherMobile',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Other Mobile
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'personalPhone',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Personal Phone
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'workPhone',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Work Phone
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'otherPhone',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Other Phone
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'personalEmail',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Personal Email
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'workEmail',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Work Email
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'OtherEmail',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Other Email
                                </th>
                                <th
                                  class="min-w-120px"
                                  (click)="
                                    leadData(
                                      'leadType',
                                      !ContactBasicForm.value.sortDirection,
                                      page,
                                      itemsPerPage
                                    )
                                  "
                                >
                                  Lead Type
                                </th>
                              </thead>

                              <!-- begin::Table Filter -->
                              <thead id="filter">
                                <th></th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="reference"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'reference',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <ng-select
                                    formControlName="statusId"
                                    bindLabel="name"
                                    (change)="
                                      onFilterSelectionDrp(
                                        'statusId',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  >
                                    <ng-option
                                      *ngFor="let status of AllStatusType"
                                      [value]="status.id"
                                      >{{ status.name }}</ng-option
                                    >
                                  </ng-select>
                                </th>
                                <th>
                                  <ng-select
                                    formControlName="subStatusId"
                                    bindLabel="name"
                                    (change)="
                                      onFilterSelectionDrp(
                                        'subStatusId',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  >
                                    <ng-option
                                      *ngFor="let sub of AllSubStatusType"
                                      [value]="sub.id"
                                      >{{ sub.name }}</ng-option
                                    >
                                  </ng-select>
                                </th>
                                <th>
                                  <ng-select style="margin-left: -8px;
                                  width: 142px;"
                                    formControlName="agentId"
                                    bindLabel="name"
                                    (change)="
                                      onFilterSelectionDrp(
                                        'agentId',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  >
                                    <ng-option
                                    *ngFor="let assignee of AgentList"
                                    [value]="assignee.id"
                                    >
                                    <!-- <span class="d-flex gap-2 align-items-center"
                                    ><ngx-avatar
                                      size="26"
                                      class="avatar"
                                      [name]="assignee?.name"
                                    ></ngx-avatar
                                    >{{ assignee.name }}</span
                                    > -->
                                    {{assignee.name}}
                                    </ng-option
                                  >
                                  </ng-select>
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="firstName"
                                    name="Firstname"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'firstName',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="lastName"
                                    name="Lastname"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'lastName',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="personalMobile"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'personalMobile',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="workMobile"
                                    name="workMobile"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'workMobile',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="otherMobile"
                                    name="otherMobile"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'otherMobile',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="personalPhone"
                                    name="personalPhone"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'personalPhone',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="workPhone"
                                    name="workPhone"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'workPhone',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="otherPhone"
                                    name="otherPhone"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'otherPhone',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="personalEmail"
                                    name="personalEmail"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'personalEmail',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="workEmail"
                                    name="workEmail"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'workEmail',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <input
                                    class="form-control mb-3 mb-lg-0"
                                    type="text"
                                    placeholder="Min 3 chars"
                                    formControlName="otherEmail"
                                    name="otherEmail"
                                    style="min-width: 40px !important"
                                    (keyup)="
                                      onFilterSelection(
                                        'otherEmail',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  />
                                </th>
                                <th>
                                  <ng-select
                                    formControlName="leadTypeId"
                                    bindLabel="name"
                                    (change)="
                                      onFilterSelectionDrp(
                                        'leadTypeId',
                                        $event,
                                        leadpage,
                                        leaditemsPerPage
                                      )
                                    "
                                  >
                                    <ng-option
                                      *ngFor="let type of LeadTypeList"
                                      [value]="type.id"
                                      >{{ type.name }}</ng-option
                                    >
                                  </ng-select>
                                </th>
                              </thead>
                              <tbody>
                                <tr
                                  *ngFor="
                                    let data of leadDetailsList
                                      | paginate
                                        : {
                                            id:'listing_viewing',
                                            itemsPerPage: leaditemsPerPage,
                                            currentPage: page,
                                            totalItems: totalItems
                                          }
                                  "
                                >
                                  <th class="w-40px">
                                    <div
                                      class="form-check form-check-sm form-check-custom form-check-solid p-0"
                                    >
                                      <input
                                        class="form-check-input cursor-pointer"
                                        type="radio"
                                        name="lead-listing"
                                        [checked]="selectedLeadId === data?.id"
                                        value="{{ data.Id }}"
                                        data-kt-check="true"
                                        data-kt-check-target=".widget-9-check"
                                        (click)="onSelectionChange(data)"
                                      />
                                    </div>
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ data?.reference }}
                                  </th>
                                  <th class="kt_activities_toggle align-middle">
                                    <span
                                      [ngClass]="
                                        data.statusName == 'Closed'
                                          ? 'text-grey'
                                          : data.statusName == 'Open'
                                          ? 'text-blue'
                                          : ''
                                      "
                                      >{{ data?.statusName }}</span
                                    >
                                  </th>
                                  <th class="kt_activities_toggle">
                                    <span
                                      [ngClass]="
                                        data.subStatusName == 'In Progress' ||
                                        data.subStatusName ==
                                          'Viewing Arranged' ||
                                        data.subStatusName == 'Offer Made' ||
                                        data.subStatusName == 'Interested' ||
                                        data.subStatusName ==
                                          'Interested To Meet' ||
                                        data.subStatusName == 'Viewing Done' ||
                                        data.subStatusName == 'Successful'
                                          ? 'text-green'
                                          : data.subStatusName ==
                                              'Budget Differs' ||
                                            data.subStatusName ==
                                              'Not Interested' ||
                                            data.subStatusName ==
                                              'Client not Reachable' ||
                                            data.subStatusName ==
                                              'Incorrect Contact Details' ||
                                            data.subStatusName ==
                                              'Invalid inquiry' ||
                                            data.subStatusName ==
                                              'Price too High' ||
                                            data.subStatusName == 'Unsuccessful'
                                          ? 'text-red'
                                          : data.subStatusName ==
                                              'Not Yet Contacted' ||
                                            data.subStatusName ==
                                              'Called No Reply' ||
                                            data.subStatusName == 'Follow Up' ||
                                            data.subStatusName ==
                                              'Client to revert' ||
                                            data.subStatusName ==
                                              'Needs More Info' ||
                                            data.subStatusName ==
                                              'Needs Time' ||
                                            data.subStatusName == 'Look-see' ||
                                            data.subStatusName ==
                                              'SMS sent to Agen' ||
                                            data.subStatusName ==
                                              'Email sent to Agent' ||
                                            data.subStatusName ==
                                              'Client Connected Online To Agent'
                                          ? 'text-blue'
                                          : ''
                                      "
                                      >{{ data?.subStatusName }}</span
                                    >
                                  </th>
                                  <th class="kt_activities_toggle">
                                    <div class="d-flex gap-2 align-items-center">
                                      <ngx-avatar *ngIf="data?.profileImage == null || data?.profileImage == ''" size="26" class="avatar" [name]="data?.agentName"></ngx-avatar>
                                      <img *ngIf="data?.profileImage != null && data?.profileImage != ''" [src]="imgUrl + data?.profileImage" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="26" [style.height.px]="26">
                                      <!-- <ngx-avatar
                                        size="26"
                                        class="avatar"
                                        [name]="data?.agentName"
                                      ></ngx-avatar> -->
                                      {{ data?.agentName }}
                                    </div>
                                    <!-- {{ data?.agentName }} -->
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ data?.firstName }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ data?.lastName }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getMobile(1, data?.leadMobile) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getMobile(2, data?.leadMobile) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getMobile(3, data?.leadMobile) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getPhone(1, data?.leadPhone) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getPhone(2, data?.leadPhone) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getPhone(3, data?.leadPhone) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getEmail(1, data?.leadEmail) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getEmail(2, data?.leadEmail) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ getEmail(3, data?.leadEmail) }}
                                  </th>
                                  <th class="kt_activities_toggle">
                                    {{ data?.leadTypeName }}
                                  </th>
                                </tr>
                              </tbody>
                            </table>

                            <div
                              class="text-center mt-5 mb-5"
                              *ngIf="
                                leadDetailsList && leadDetailsList?.length === 0
                              "
                            >
                              Record not available
                            </div>
                            <div>
                              <div
                                class="d-flex justify-content-between flex-column-reverse me-auto"
                              >
                                <pagination-controls
                                  *ngIf="leadDetailsList.length > 0"
                                  (pageChange)="renderleadPage($event)" id="listing_viewing"
                                ></pagination-controls>
                                <span class="d-block mb-3"
                                  >Showing {{ leadDetailsList.length }} of
                                  <b>{{ totalItems }}</b> Leads</span
                                >
                              </div>
                            </div>
                            <!-- end::Table -->
                          </div>
                          <!--./table-responsive-->
                          <!-- end::Table -->
                        </div>
                        <div class="modal-footer py-3">
                          <button
                            (click)="onCancelList()"
                            class="btn btn-sm btn-light btn-active-light-primary me-3"
                          >
                            Cancel
                          </button>
                          <button
                            (click)="onSaveList()"
                            class="btn btn-sm btn-primary" [disabled]="leadViewingApplay == null"
                          >
                            Apply
                          </button>
                        </div>
                      </div>
                    </form>
                  </div>
                </ng-template>
                <div class="row mb-6 mt-6">
                  <label class="col-lg-3 col-form-label fw-bold fs-6 required"
                    >Start Date</label
                  >
                  <div class="col-lg-3">
                    <input
                      type="date"
                      id="startDate"
                      class="form-control form-control-lg mb-3 mb-lg-0"
                      formControlName="startDate"
                      [ngClass]="
                        isViewingSubmitted && fv['startDate'].invalid
                          ? 'border-error'
                          : ''
                      "
                      [ngClass]="{
                        'ph-date-selected': fv['startDate'].invalid !== null
                      }"
                    />
                    <div
                      *ngIf="isViewingSubmitted && fv['startDate'].invalid"
                      class="required-feedback"
                    >
                      <div class="error-text">Start Date is required</div>
                    </div>
                  </div>
                  <div class="col-lg-3">
                    <input
                      type="time"
                      id="startDateTime"
                      class="form-control form-control-lg mb-3 mb-lg-0"
                      formControlName="startDateTime"
                      [ngClass]="
                        isViewingSubmitted && fv['startDateTime'].invalid
                          ? 'border-error'
                          : ''
                      "
                    />
                    <div
                      *ngIf="isViewingSubmitted && fv['startDateTime'].invalid"
                      class="required-feedback"
                    >
                      <div class="error-text">Start Time is required</div>
                    </div>
                  </div>
                </div>
                <div class="row mb-6">
                  <label class="col-lg-3 col-form-label fw-bold fs-6 required"
                    >End Date</label
                  >
                  <div class="col-lg-3">
                    <input
                      type="date"
                      id="endDate"
                      class="form-control form-control-lg mb-3 mb-lg-0"
                      formControlName="endDate"
                      [ngClass]="
                        isViewingSubmitted && fv['endDate'].invalid
                          ? 'border-error'
                          : ''
                      "
                      [ngClass]="{
                        'ph-date-selected': fv['endDate'].invalid !== null
                      }"
                    />
                    <div
                      *ngIf="isViewingSubmitted && fv['endDate'].invalid"
                      class="required-feedback"
                    >
                      <div class="error-text">End Date is required</div>
                    </div>
                  </div>
                  <div class="col-lg-3">
                    <input
                      type="time"
                      id="endDateTime"
                      class="form-control form-control-lg mb-3 mb-lg-0"
                      formControlName="endDateTime"
                      [ngClass]="
                        isViewingSubmitted && fv['endDateTime'].invalid
                          ? 'border-error'
                          : ''
                      "
                    />
                    <div
                      *ngIf="isViewingSubmitted && fv['endDateTime'].invalid"
                      class="required-feedback"
                    >
                      <div class="error-text">End Time is required</div>
                    </div>
                  </div>
                </div>
                <div class="row mb-6">
                  <label class="col-lg-3 col-form-label fw-bold fs-6"
                    >Notes</label
                  >
                  <div class="col-lg-6">
                    <div>
                      <textarea
                        name="Notes"
                        formControlName="notes"
                        id="Notes"
                        cols="50"
                        rows="10"
                      ></textarea>
                    </div>
                  </div>
                </div>
                <div class="row mb-6">
                  <div class="col-lg-6">
                    <a
                      (click)="cancelLead()"
                      class="btn btn-sm btn-light btn-active-light-primary fw-bold me-1"
                    >
                      <i class="bi bi-right"></i> Cancel
                    </a>
                    <a
                      (click)="onLeadSave()"
                      class="btn btn-sm btn-flex btn-primary fw-bold me-1"
                    >
                      <i class="bi bi-right"></i> Save
                    </a>
                  </div>
                </div>
              </div>
            </form>
          </div>
            <div class="card card-bordered my-4 px-4 p-3" *ngFor="let viewData of viewingList">
              <table class="ph-table-inner mw-75">
                <tr>
                  <td>
                    <b>Viewing Reference No:</b>
                  </td>
                  <td class="d-flex align-items-center">
                    {{ viewData.reference }}
                    <div id="test" class="position-relative ph-hover">
                      <a href="#" class="btn btn-icon btn-sm ph-hover__trigger">
                        <i class="bi bi-clock fs-3"></i>
                      </a>
                      <div class="menu menu-sub menu-sub-dropdown p-4 ph-hover__menu">
                        <small>
                          Created: {{ viewData.created   | date : "dd/MM/yyyy hh:mm:ss a "}}<br />
                          Updated: {{ viewData.updated   | date : "dd/MM/yyyy hh:mm:ss a"}}<br />
                        </small>
                      </div>
                    </div>
                    <div class="ms-auto">
                      <button class="btn btn-sm btn-primary mr-2" (click)="OnViewingEdit(viewData)">
                        Edit
                      </button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td ><b>Status:</b></td>
                  <td>{{ viewData.status }}</td>
                </tr>
                <tr>
                  <td><b>Assigned To:</b></td>
                  <td>{{ viewData.agentName }}</td>
                </tr>
                <tr>
                  <td><b>Lead Reference:</b></td>
                  <td>{{ viewData.leadReference }}</td>
                </tr>
                <tr>
                  <td><b>Start Date:</b></td>
                  <td>
                    {{ viewData.startDate | date : "dd/MM/yyyy" }} &nbsp;
                    {{ viewData.startDateTime | date : "hh:mm:ss a" }}
                  </td>
                </tr>
                <tr>
                  <td><b>End Date:</b></td>
                  <td>
                    {{ viewData.endDate | date : "dd/MM/yyyy" }} &nbsp;
                    {{ viewData.endDateTime | date : "hh:mm:ss a" }}
                  </td>
                </tr>
                <tr>
                  <td><b>Notes:</b></td>
                  <td>{{ viewData.notes }}</td>
                </tr>
              </table>
            </div>

        </div>
        <!--./Tab3-->
      </div>
      <!--./card-body-->
    </form>
  </div>
</div>

<div id="splash-screen" class="splash-screen" *ngIf="IsLoading">
  <img src="./assets/media/logos/prophero-small.svg" alt="PropHero logo" />
  <span>Loading ...</span>
</div>
<div id="kt_contact-details" class="bg-body" data-kt-drawer="true" data-kt-drawer-name="contact-details"
  data-kt-drawer-activate="true" data-kt-drawer-overlay="false" data-kt-drawer-width="{default:'300px', 'lg': '900px'}"
  data-kt-drawer-direction="end" data-kt-drawer-toggle=".kt_contact-details_toggle"
  data-kt-drawer-close="#kt_contact-details_close" #container>
  <div class="card shadow-none rounded-0 w-100">
    <form>
    <div class="card-header" id="kt_contact-details_header">
      <div>
        <div class="card-title fw-bold text-dark">
          <span *ngIf="isAdd">New Contact</span>
          <span *ngIf="!isAdd">{{contactDetails?.ref}}</span>
          
          <div class="ms-2" *ngIf="!isAdd">
            <!--begin::Dropview toggle-->
            <a
              class="btn btn-icon btn-sm"
              data-kt-menu-trigger="{default: 'hover'}"
              data-kt-menu-attach="parent"
              data-kt-menu-placement="bottom-start"
            >
              <i class="bi bi-clock fs-3"></i>
            </a>
            <!--end::Dropview toggle-->

            <!--begin::Dropview-->
            <div
              class="menu menu-sub menu-sub-dropdown p-4"
              data-kt-menu="true"
            >
              <small>
                Created: {{ contactDetails?.created | date : "dd/MM/yyyy hh:mm:ss a " }}<br />
                Updated: {{ contactDetails?.updated | date : "dd/MM/yyyy hh:mm:ss a" }}<br />
               
              </small>
            </div>
            <!--end::Dropview-->
          </div>
        </div>
        <div class="card-toolbar">
          <button type="button" class="btn btn-sm btn-icon btn-active-light-primary"
            id="kt_contact-details_close" (click)="closeContact()">
            <app-keenicon name="cross" class="fs-1"></app-keenicon>
          </button>
        </div>
      </div>
      <div class="d-flex align-items-center">
        <ul class="nav nav-stretch nav-line-tabs nav-line-tabs-2x border-transparent fs-5 fw-bold">
            <!--begin::Nav item-->
            <li class="nav-item">
              <a
                class="nav-link text-active-primary ms-0 me-10 py-5 active cursor-pointer"
                [class.active]="selectedTab === 'tab1'"
                (click)="selectTab('tab1')"
              >
                Details
              </a>
            </li>

            <li class="nav-item">
              <a
                class="nav-link text-active-primary ms-0 me-10 py-5 cursor-pointer"
                [class.active]="selectedTab === 'tab2'"
                (click)="selectTab('tab2')"
              >
                Notes
              </a>
            </li>
            
          </ul>
          <div class="d-flex align-items-center" *ngIf="selectedTab === 'tab1'">
            <button
            (click)="onCancel()"
            class="btn btn-sm btn-light btn-active-light-primary me-3"
            *ngIf="isEdit"
          >
            Cancel
          </button>
            <button *ngIf="isAdd || isEdit"
            (click)="onSubmit()"
            class="btn btn-sm btn-primary"
          >
            Save
          </button>
          <button *ngIf="isView && isEditContactPermission"
          (click)="onEdit()"
          class="btn btn-sm btn-primary"
        >
          Edit
        </button>
          </div>
       
      </div>
    </div>
    <div class="card-body position-relative p-0" id="kt_activities_body">
      <div *ngIf="selectedTab == 'tab1'">
      <ul class="accordian-shortcuts">
        <li id="sec_1_1">
          <button (click)="scrollToElement('sec1'); basic = true" [ngClass]="isSave && (basicDetailForm.invalid || isDuplicatePhone)  ? 'border-error' : ''">
            <i class="bi bi-house"></i>
          </button>
          <span class="reveal">Basic Details</span>
        </li>
        <li id="sec_2_1">
          <button (click)="scrollToElement('sec2'); iscontactdetails = true" [ngClass]="isSave && (contactForm.invalid || isDuplicateMobile || isDuplicateEmail || isDuplicatePhone) ? 'border-error' : ''">
            <i class="bi bi-person-vcard"></i>
          </button>
          <span class="reveal">Contact Details</span>
        </li>
        <li id="sec_4_1">
          <button (click)="scrollToElement('sec4'); isAdditionalInfo = true" [ngClass]="isSave && AdditionalInfoForm.invalid ? 'border-error' : ''">
            <i class="bi bi-list-task"></i>
          </button>
          <span class="reveal">Additional Details</span>
        </li>
        <li id="sec_2_1">
          <button (click)="scrollToElement('sec5'); isAddressDetails = true" [ngClass]="isSave && addressForm.invalid ? 'border-error' : ''">
            <i class="bi bi-geo-alt"></i>
          </button>
          <span class="reveal">Address</span>
        </li>
        <li id="sec_3_1">
          <button (click)="scrollToElement('sec3'); isSocialMedia = true" [ngClass]="isSave && SocialMediaForm.invalid ? 'border-error' : ''">
            <i class="bi bi-app-indicator"></i>
          </button>
          <span class="reveal">Social Media</span>
        </li>
        
       
      </ul>
    <div class="accordion" id="kt_accordion_1" #container>
      <div class="accordion-item" id="sec1">
        <h2 class="accordion-header" id="kt_accordion_1_header_1">
          <button class="accordion-button fs-4 fw-semibold" type="button" (click)="basic = !basic"
            [class.collapsed]="!basic" [ngClass]="isSave && (basicDetailForm.invalid || isDuplicatePhone) ? 'border-error' : ''">
            Basic Details
          </button>
        </h2>
        <div id="kt_accordion_1_body_1" class="accordion-collapse collapse" [class.show]="basic">
          <div class="accordion-body">
            <form [formGroup]="basicDetailForm">

              <!-- <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Profile Photo</label>
                <div class="col-lg-6">
                  <div class="form-check form-switch form-switch-sm form-check-custom form-check-solid">
                    <label for="profilePhoto" class="btn btn-sm btn-primary">
                      Upload
                      <input type="file" [disabled]="isView" id="profilePhoto"accept="image/*" (change)="previewImage($event)" #fileInput style="display:none"/>
                    </label>
                    
                    <div id="imagePreview" class="ml-5" *ngIf="imagePath != null">
                      <img [src]="imagePath" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="50" [style.height.px]="50">
                      <div *ngIf="imagePath != null && !isView">
                        <a href="javascript:void(0);" (click)="DeleteImage()">Delete</a>
                      </div>
                    </div>
                    
                  </div>
                </div>
              </div> -->

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6 required">Assigned To</label>
                <div class="col-lg-6">
                  <ng-select formControlName="AssignedTo" bindLabel="name" id="assignedToId" [ngClass]="isSave && assignedto.invalid ? 'border-error' : ''">
                    <!-- <ng-option value="" selected>Select Assign To</ng-option> -->
                    <ng-option *ngFor="let assignee of assignToList" [value]="assignee.id">
                      <span class="d-flex gap-2 align-items-center">
                        <ngx-avatar *ngIf="assignee.profileImage == null || assignee.profileImage == ''" size="26" class="avatar" [name]="assignee?.name"></ngx-avatar>
                        <img *ngIf="assignee.profileImage != null && assignee.profileImage != ''" [src]="assignee.profileImage" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="26" [style.height.px]="26">
                        {{ assignee.name }}</span></ng-option>
                  </ng-select>
                  <div *ngIf="isSave && assignedto.invalid" class="required-feedback">
                    <div class="error-text">
                      Assigned To is required
                    </div>
                </div>
                </div>
              </div>


              
              
              <!-- <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Ref</label>
                <div class="col-lg-6">
                  <input type="text" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0" formControlName="Ref" />
                </div>
              </div> -->

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Title</label>
                <div class="col-lg-6">
                  <ng-select formControlName="Title" bindLabel="name" id="titleId">
                    <!-- <ng-option value="" selected>Select</ng-option> -->
                    <ng-option *ngFor="let title of titleList" [value]="title.id">{{ title.name }}</ng-option>
                  </ng-select>
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6 required">First Name</label>
                <div class="col-lg-6">
                  <input type="text" id="firstName" class="form-control form-control-lg mb-3 mb-lg-0" formControlName="FirstName" (keyup)="changePhoneDetail()"
                    [ngClass]="isSave && (firstName.invalid || isDuplicatePhone) ? 'border-error' : ''"/>
                  <div *ngIf="isSave && firstName.invalid" class="required-feedback">
                    <div class="error-text">
                      First Name is required
                    </div>
                  </div>
                  <div *ngIf="isSave && isDuplicatePhone" class="required-feedback">
                    <div class="error-text">
                      User already exists with this Contact Full Name and Phone
                    </div>
                  </div>
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Last Name</label>
                <div class="col-lg-6">
                  <input type="text" id="lastName" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="LastName" [ngClass]="isSave && (lastName.invalid || isDuplicatePhone) ? 'border-error' : ''" (keyup)="changePhoneDetail()" />
                                    <div *ngIf="isSave && lastName.invalid" class="required-feedback">
                                      <div class="error-text">
                                        Last Name is required
                                      </div>
                                    </div>
                                    <div *ngIf="isSave && isDuplicatePhone" class="required-feedback">
                                      <div class="error-text">
                                        User already exists with this Contact Full Name and Phone
                                      </div>
                                    </div>
                </div>
              </div>             
            </form>
          </div>
        </div>
      </div>
      <div class="accordion-item" id="sec2">
        <h2 class="accordion-header" id="kt_accordion_1_header_2">
          <button class="accordion-button fs-4 fw-semibold" type="button" (click)="iscontactdetails = !iscontactdetails"
            [class.collapsed]="!iscontactdetails" [ngClass]="isSave && (contactForm.invalid || isDuplicateMobile || isDuplicateEmail || isDuplicatePhone) ? 'border-error' : ''">
            Contact Details
          </button>
        </h2>
        <div id="kt_accordion_1_body_2" class="accordion-collapse collapse" [class.show]="iscontactdetails">
          <div class="accordion-body">
            <form [formGroup]="contactForm">

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Mobile</label>
               
                <div class="col-lg-6 mb-3">
                  
                    <div formArrayName="Mobiles" class="mb-3" *ngFor="let item of MobileFormGroups.controls; let i = index;">
                      <div [formGroupName]="i">
    
                          <input type="hidden" formControlName="id">
    
                          <!-- <ng-select formControlName="MobileType" bindLabel="name" id="titleId" (change)="changeMobileType(i)" [class.is-invalid]=" 
                          (MobileFormGroups.controls[i].get('MobileType')?.invalid)"> -->
                            <ng-select class="mb-3" formControlName="MobileType" bindLabel="name" id="titleId"  [ngClass]="isSave && contactForm?.invalid && !EmailFormGroups?.invalid &&  (MobileFormGroups.controls[i].get('MobileType')?.value == null ||  MobileFormGroups.controls[i].get('MobileType')?.value == '')? 'border-error' : ''">
                              <!-- <ng-option value="" selected>Select</ng-option> -->
                              
                              <ng-container *ngFor="let mobileType of MobileTypeList">
                                <!-- According to Propspace -->

                                <!-- <ng-option [value]="mobileType.id" *ngIf="i == 0 && mobileType.id == 1">
                                  {{ mobileType.name }}
                                </ng-option>
                                <ng-option [value]="mobileType.id" *ngIf="i>0 && mobileType.id != 1">
                                  {{ mobileType.name }}
                                </ng-option> -->
                                <ng-option [value]="mobileType.id">
                                  {{ mobileType.name }}
                                </ng-option>
                                
                              </ng-container>
                            </ng-select>
                            <div *ngIf="isSave && MobileFormGroups.controls[i].get('MobileType')?.invalid" class="mb-3 required-feedback">
                              <div class="error-text">
                                Type is required
                              </div>
                            </div>
                            
                            <div class="input-group">
                              <!--  -->

                              <ng-select [items]="CountryCodeList" (change)="changeMobileDetail()" formControlName="CountryCode" bindLabel="name" bindValue="id"  [ngClass]="isSave && (contactForm?.invalid && !EmailFormGroups?.invalid && (MobileFormGroups.controls[i].get('CountryCode')?.value == null || MobileFormGroups.controls[i].get('CountryCode')?.value == '') || (isDuplicateMobile && DuplicateMobileId == i )) ? 'border-error' : ''">
                                <ng-template ng-label-tmp let-item="item">
                                    {{item.code}}
                                </ng-template>
                            </ng-select>
                            
                              <input type="text" id="Ref" (keypress)="isNumber($event)" (keyup)="changeMobileDetail()"  class="form-control form-control-lg mb-3 mb-lg-0"
                              formControlName="Mobile" [ngClass]="isSave && (contactForm?.invalid && !EmailFormGroups?.invalid &&  (MobileFormGroups.controls[i].get('Mobile')?.value == null || MobileFormGroups.controls[i].get('Mobile')?.value == '') || (isDuplicateMobile && DuplicateMobileId == i )) ? 'border-error' : ''"/>
                              
                            </div><!--./input-group-->
                            <div *ngIf="isSave && MobileFormGroups.controls[i].get('CountryCode')?.invalid" class="required-feedback">
                              <div class="error-text">
                                Country Code is required
                              </div>
                            </div>
                            <div *ngIf="isSave && MobileFormGroups.controls[i].get('Mobile')?.invalid" class="required-feedback">
                              <div class="error-text">Mobile is required</div>
                            </div>
                            <div *ngIf="isSave && contactForm?.invalid && !EmailFormGroups?.invalid" class="required-feedback">
                              <div class="error-text">Mobile or Phone or Email is required</div>
                            </div>
                            <div *ngIf="isSave && isDuplicateMobile && (DuplicateMobileId == i )" class="required-feedback">
                              <div class="error-text">User already exists with this Mobile</div>
                            </div>
                            <div class="col-sm-12 text-end p-0" *ngIf="i>0 && !isView">
                              <a href="javascript:void(0)" id="hiderepeateRule" (click)="removeMobile(i)" class="btn btn-icon-danger btn-text-danger btn-sm px-0">
                                <i class="bi bi-trash"></i> Delete
                              </a>
                            </div>
                      </div>
                    </div>
                  

                    <a href="javascript:void(0)" *ngIf="Mobiles.length<3 && !isView" (click)="addMobile()" id="repeateRule"
                      class="btn btn-bg-light btn-icon-primary btn-text-primary mt-3"> <i class="bi bi-plus"></i> Add Mobile</a>
                </div><!--./col-lg-6-->
              </div><!--./row-->

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Phone</label>
                
                <div class="col-lg-6 mb-3">
                  <div formArrayName="Phones" class="mb-3" *ngFor="let item of PhoneFormGroups.controls; let i = index;">
                    <div [formGroupName]="i">
  
                      <input type="hidden" formControlName="id">
                      <ng-select class="mb-3" formControlName="PhoneType" bindLabel="name" id="titleId" [ngClass]="isSave && !EmailFormGroups?.invalid && contactForm?.invalid &&  (PhoneFormGroups.controls[i].get('PhoneType')?.value == null || PhoneFormGroups.controls[i].get('PhoneType')?.value == '') ? 'border-error' : ''" >
                        <!-- <ng-select formControlName="PhoneType" bindLabel="name" id="titleId" (change)="changePhoneType(i)"> -->
                          <!-- <ng-option value="" selected>Select</ng-option> -->
                          
                          <ng-container *ngFor="let mobileType of MobileTypeList">
                            <!-- According to Propspace -->

                            <!-- <ng-option [value]="mobileType.id" *ngIf="i == 0 && mobileType.id == 1">
                              {{ mobileType.name }}
                            </ng-option>
                            <ng-option [value]="mobileType.id" *ngIf="i>0 && mobileType.id != 1">
                              {{ mobileType.name }}
                            </ng-option> -->
                            <ng-option [value]="mobileType.id">
                              {{ mobileType.name }}
                            </ng-option>
                            
                          </ng-container>
                      </ng-select>

                      <div class="input-group">
                        <!-- <ng-select formControlName="CountryCode"  bindLabel="name" id="titleId" >
                          <ng-option *ngFor="let countryCode of CountryCodeList" [value]="countryCode.id">{{
                            countryCode.name + "(" + countryCode.code + ")" }}</ng-option>
                        </ng-select> -->

                        <ng-select [items]="CountryCodeList" formControlName="CountryCode" (change)="changePhoneDetail()" bindLabel="name" bindValue="id" [ngClass]="isSave && (!EmailFormGroups?.invalid && contactForm?.invalid &&  (PhoneFormGroups.controls[i].get('CountryCode')?.value == null || PhoneFormGroups.controls[i].get('CountryCode')?.value == '') || (isDuplicatePhone && DuplicatePhoneId == i)) ? 'border-error' : ''">
                          <ng-template ng-label-tmp let-item="item">
                              {{item.code}}
                          </ng-template>
                      </ng-select>
                        
                        <input type="text" (keypress)="isNumber($event)" (keyup)="changePhoneDetail()" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0" [ngClass]="isSave && (!EmailFormGroups?.invalid && contactForm?.invalid &&  (PhoneFormGroups.controls[i].get('Phone')?.value == null || PhoneFormGroups.controls[i].get('Phone')?.value == '') || (isDuplicatePhone && DuplicatePhoneId == i)) ? 'border-error' : ''"
                          formControlName="Phone" />
                      </div>
                      <div *ngIf="isSave && contactForm?.invalid && !EmailFormGroups?.invalid" class="required-feedback">
                        <div class="error-text">Mobile or Phone or Email is required</div>
                      </div>
                      <div *ngIf="isSave && isDuplicatePhone && (DuplicatePhoneId == i )" class="required-feedback">
                        <div class="error-text">User already exists with this Contact Full Name and Phone</div>
                      </div>
                        <div class="col-sm-12 text-end p-0" *ngIf="i>0 && !isView">
                          <a href="javascript:void(0)" id="hiderepeateRule" (click)="removePhone(i)" class="btn btn-icon-danger btn-text-danger btn-sm px-0">
                            <i class="bi bi-trash"></i> Delete
                          </a>
                        </div>
                      </div>
                  </div>
                  <a href="javascript:void(0)" *ngIf="Phones.length<3 && !isView" (click)="addPhone()" id="repeateRule"
                    class="btn btn-bg-light btn-icon-primary btn-text-primary mt-3"><i class="bi bi-plus"></i> Add Phone</a>
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Email</label>
               
                <div class="col-lg-6 mb-3">
                  <div formArrayName="Emails" class="mb-3" *ngFor="let item of EmailFormGroups.controls; let i = index;">
                    <div [formGroupName]="i">
  
                      <input type="hidden" formControlName="id">
                      <ng-select class="mb-3" formControlName="EmailType" bindLabel="name" id="titleId" [ngClass]="isSave && (contactForm?.invalid && (EmailFormGroups.controls[i].get('EmailType')?.value == null || EmailFormGroups.controls[i].get('EmailType')?.value == ''))  ? 'border-error' : ''">
                        <!-- <ng-select formControlName="EmailType" bindLabel="name" id="titleId" (change)="changeEmailType(i)" [class.is-invalid]=" 
                        (EmailFormGroups.controls[i].get('EmailType')?.invalid)"> -->
                        <!-- <ng-option value="" selected>Select</ng-option> -->
                          
                        <ng-container *ngFor="let mobileType of MobileTypeList">
                          <!-- According to Propspace -->

                          <!-- <ng-option [value]="mobileType.id" *ngIf="i == 0 && mobileType.id == 1">
                            {{ mobileType.name }}
                          </ng-option>
                          <ng-option [value]="mobileType.id" *ngIf="i>0 && mobileType.id != 1">
                            {{ mobileType.name }}
                          </ng-option> -->
                          <ng-option [value]="mobileType.id">
                            {{ mobileType.name }}
                          </ng-option>
                          
                        </ng-container>
                        </ng-select>
                        <div *ngIf="isSave && EmailFormGroups.controls[i].get('EmailType')?.invalid" class="mb-3 required-feedback">
                          <div class="error-text">
                            Email Type is required
                          </div>
                        </div>
                        
                        <input type="text" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0" (keyup)="changeEmailDetail()"
                          formControlName="Email" [ngClass]="isSave && (contactForm?.invalid && (EmailFormGroups.controls[i].get('Email')?.value == null || EmailFormGroups.controls[i].get('Email')?.value == '') || (isDuplicateEmail && DuplicateEmailId == i ))  ? 'border-error' : ''"/>
                          <div *ngIf="isSave && EmailFormGroups.controls[i].get('Email')?.invalid" class="mb-3 required-feedback">
                            <div class="error-text">
                              Email is invalid
                            </div>
                          </div>
                          <div *ngIf="isSave && contactForm?.invalid && !EmailFormGroups?.invalid" class="required-feedback">
                            <div class="error-text">Mobile or Phone or Email is required</div>
                          </div>
                          <div *ngIf="isSave && isDuplicateEmail && (DuplicateEmailId == i )" class="required-feedback">
                            <div class="error-text">User already exists with this Email</div>
                          </div>
                        <div class="col-sm-12 text-end p-0" *ngIf="i>0 && !isView">
                          <a href="javascript:void(0)" id="hiderepeateRule" (click)="removeEmail(i)" class="btn btn-icon-danger btn-text-danger btn-sm px-0">
                            <i class="bi bi-trash"></i> Delete
                          </a>
                        </div>
                    </div>
                  </div>
                  <a href="javascript:void(0)" *ngIf="Emails.length<3 && !isView" (click)="addEmail()" id="repeateRule"
                    class="btn btn-bg-light btn-icon-primary btn-text-primary mt-3"> <i class="bi bi-plus"></i> Add Email</a>
                </div>
              </div>

              <!-- Fax (Not in Excel) -->
              <!-- <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Fax</label>
                
                <div class="col-lg-6 mb-3">
                  <div formArrayName="Faxes" *ngFor="let item of FaxFormGroups.controls; let i = index;">
                    <div [formGroupName]="i">
  
                      <input type="hidden" formControlName="id">
                        <ng-select formControlName="FaxType" bindLabel="name" id="titleId">
                          
                          <ng-container *ngFor="let mobileType of MobileTypeList">
                            
                            <ng-option [value]="mobileType.id">
                              {{ mobileType.name }}
                            </ng-option>
                            
                          </ng-container>
                        </ng-select>
                        
                        <ng-select formControlName="CountryCode" bindLabel="name" id="titleId">
                          <ng-option *ngFor="let countryCode of CountryCodeList" [value]="countryCode.id">{{
                            countryCode.name + "(" + countryCode.code + ")" }}</ng-option>
                        </ng-select>
                        <input type="text" (keypress)="isNumber($event)" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0"
                          formControlName="Fax" />
                        <div class="col-sm-12 text-end p-0" *ngIf="i>0 && !isView">
                          <a href="javascript:void(0)" id="hiderepeateRule" (click)="removeFax(i)">
                            Delete</a>
                        </div>
                    </div>
                  </div>
                  <a href="javascript:void(0)" *ngIf="Faxes.length<3 && !isView" (click)="addFax()" id="repeateRule"
                    class="btn btn-bg-light btn-icon-primary btn-text-primary mt-3"> <i class="bi bi-plus"></i> Add Fax</a>
                </div>
              </div> -->




              <!--Address Details-->

              
              
             
            </form>
          </div>
        </div>
      </div>
      <div class="accordion-item" id="sec4">
        <h2 class="accordion-header" id="kt_accordion_1_header_4">
          <button class="accordion-button fs-4 fw-semibold" type="button" (click)="isAdditionalInfo = !isAdditionalInfo"
            [class.collapsed]="!isAdditionalInfo" [ngClass]="isSave && AdditionalInfoForm.invalid ? 'border-error' : ''">
            Additional Details
          </button>
        </h2>
        <div id="kt_accordion_1_body_4" class="accordion-collapse collapse" [class.show]="isAdditionalInfo">
          <div class="accordion-body">
            <form [formGroup]="AdditionalInfoForm">
              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Contact Type</label>
                <div class="col-lg-6">
                  <ng-select formControlName="ContactType" bindLabel="name" id="titleId">
                    <!-- <ng-option value="" selected>Select</ng-option> -->
                    <ng-option *ngFor="let contactType of ContactTypeList" [value]="contactType.id">{{ contactType.name
                      }}</ng-option>
                  </ng-select>
                </div>
              </div>
              
              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">VIP</label>
                <div class="col-lg-6 d-flex align-items-center">
                  <div class="form-check form-switch form-switch-sm form-check-custom form-check-solid">
                    <input class="form-check-input" id="managed" type="checkbox" formControlName="Vip" />
                  </div>
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Gender</label>
                <div class="col-lg-6">
                  <ng-select formControlName="Gender" bindLabel="name" id="titleId">
                    <!-- <ng-option value="" selected>Select</ng-option> -->
                    <ng-option *ngFor="let gender of GenderList" [value]="gender.id">{{ gender.name }}</ng-option>
                  </ng-select>
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Date of Birth</label>
                <div class="col-lg-6">
                  <input type="date" class="form-control form-control-lg mb-3 mb-lg-0" id="dobDate"
                    formControlName="DateofBirth" placeholder="Select date"
                    [ngClass]="{'ph-date-selected': AdditionalInfoForm.controls['DateofBirth'].value !== null}" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Nationality</label>
                
                <div class="col-lg-6 mb-3">
                  <div formArrayName="Nationalities" class="mb-3" *ngFor="let item of NationslityFormGroups.controls; let i = index;">
                    <div [formGroupName]="i">
                      <input type="hidden" formControlName="id">
                        <ng-select formControlName="Nationality" bindLabel="name" id="titleId">
                          <!-- <ng-option value="" selected>Select</ng-option> -->
                          <ng-option *ngFor="let nationality of NationalitiesList" [value]="nationality.id">{{
                            nationality.countryName }}</ng-option>
                        </ng-select>
                        <div class="col-sm-12 text-end p-0" *ngIf="i>0 && !isView">
                          <a href="javascript:void(0)" id="hiderepeateRule" (click)="removeNationality(i)" class="btn btn-icon-danger btn-text-danger btn-sm px-0">
                            <i class="bi bi-trash"></i> Delete
                          </a>
                        </div>
                    </div>
                  </div>
                  <a href="javascript:void(0)" *ngIf="Nationalities.length<2 && !isView" (click)="addNationality()"
                    id="repeateRule" class="btn btn-bg-light btn-icon-primary btn-text-primary mt-3"> <i class="bi bi-plus"></i> Add Nationality</a>
                </div><!--./col-lg-6-->
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Religion</label>
                <div class="col-lg-6">
                  <ng-select formControlName="Religion" bindLabel="name" id="titleId">
                    <!-- <ng-option value="" selected>Select</ng-option> -->
                    <ng-option *ngFor="let religion of ReligionList" [value]="religion.id">{{ religion.name
                      }}</ng-option>
                  </ng-select>
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Languages</label>
                <div class="col-lg-6 mb-3">
                  <div formArrayName="Languages" class="mb-3" *ngFor="let item of LanguageFormGroups.controls; let i = index;">
                    <div [formGroupName]="i">
  
                      <input type="hidden" formControlName="id">

                        <ng-select formControlName="Language" bindLabel="name" id="titleId">
                          <!-- <ng-option value="" selected>Select</ng-option> -->
                          <ng-option *ngFor="let language of LanguagesList" [value]="language.id">{{ language.languageName
                            }}</ng-option>
                        </ng-select>
                        <div class="col-sm-12 text-end p-0" *ngIf="i>0 && !isView">
                          <a href="javascript:void(0)" id="hiderepeateRule" (click)="removeLanguage(i)" class="btn btn-icon-danger btn-text-danger btn-sm px-0">
                            <i class="bi bi-trash"></i> Delete
                          </a>
                        </div>
  
                    </div>
                  </div>

                  <a href="javascript:void(0)" *ngIf="Languages.length<2 && !isView" (click)="addLanguage()" id="repeateRule"
                    class="btn btn-bg-light btn-icon-primary btn-text-primary mt-3"> <i class="bi bi-plus"></i> Add Language</a>
                </div><!--./col-lg-6-->
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Hobbies</label>
                <div class="col-lg-6">
                  <!-- <ng-multiselect-dropdown [settings]="dropdownSettings" placeholder="" [disabled]="isView" [data]="HobbiesList" [(ngModel)]="Hobbies" [ngModelOptions]="{standalone: true}">
                  </ng-multiselect-dropdown> -->
                  <ng-select
    [items]="HobbiesList"
    [multiple]="true"
    [disabled]="isView"
    [closeOnSelect]="false"
    [searchable]="true"
    bindLabel="text"
    bindValue="id"
    [(ngModel)]="Hobbies"
    [ngModelOptions]="{standalone: true}"
    >
</ng-select>
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Contact Source</label>
                <div class="col-lg-6">
                  <ng-select formControlName="ContactSource" bindLabel="name" id="titleId">
                    <!-- <ng-option value="" selected>Select</ng-option> -->
                    <ng-option *ngFor="let contactsource of ContactSourceList" [value]="contactsource.id">{{
                      contactsource.name }}</ng-option>
                  </ng-select>
                </div>
              </div>

              

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Company Name</label>
                <div class="col-lg-6">
                  <input type="text" id="companyName" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="CompanyName" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Designation</label>
                <div class="col-lg-6">
                  <input type="text" id="designation" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="Designation" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Website</label>
                <div class="col-lg-6">
                  <input type="text" id="website" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="Website" />
                </div>
              </div>

              

              <!-- <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Created By</label>
                <div class="col-lg-6">
                  <input type="text" id="CreatedBy" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="CreatedBy" />
                </div>
              </div> -->
            </form>
          </div>
        </div>
      </div>
      <div class="accordion-item" id="sec5">
        <h2 class="accordion-header" id="kt_accordion_1_header_3">
          <button class="accordion-button fs-4 fw-semibold" type="button" (click)="isAddressDetails = !isAddressDetails"
            [class.collapsed]="!isAddressDetails"  [ngClass]="isSave && addressForm.invalid ? 'border-error' : ''">
            Address
          </button>
        </h2>
        <div id="kt_accordion_1_body_3" class="accordion-collapse collapse" [class.show]="isAddressDetails">
          <div class="accordion-body">
            <form [formGroup]="addressForm">
              <div formArrayName="Addresses" *ngFor="let item of AddressFormGroups.controls; let i = index;">
                <div [formGroupName]="i">
                  
                  <input type="hidden" formControlName="id">

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">Address Type</label>
                    <div class="col-lg-6">
                      <ng-select formControlName="AddressType" bindLabel="name" id="titleId" (change)="changeAddressType(i)">
                        <!-- <ng-option value="" selected>Select</ng-option> -->
                        
                        <ng-container *ngFor="let mobileType of MobileTypeList">
                          <!-- <ng-option [value]="mobileType.id" *ngIf="i == 0 && mobileType.id == 1">
                            {{ mobileType.name }}
                          </ng-option>
                          <ng-option [value]="mobileType.id" *ngIf="i>0 && mobileType.id == 2">
                            {{ mobileType.name }}
                          </ng-option> -->
                          <ng-option [value]="mobileType.id" *ngIf="mobileType.id != 3">
                            {{ mobileType.name }}
                          </ng-option>
                        </ng-container>
                      </ng-select>
                    </div>
                  </div><!--./row-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">PO Box</label>
                    <div class="col-lg-6">
                      <input type="text" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="POBox" />
                    </div>
                  </div><!--./row-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">Address Line 1</label>
                    <div class="col-lg-6">
                      <input type="text" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="AddressLine1" />
                    </div>
                  </div><!--./row-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">Address Line 2</label>
                    <div class="col-lg-6">
                      <input type="text" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="AddressLine2" />
                    </div>
                  </div><!--./row-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">City</label>
                    <div class="col-lg-6">
                      <input type="text" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="City" />
                    </div>
                  </div><!--./row-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">Zip Code</label>
                    <div class="col-lg-6">
                      <input type="text" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="ZipCode" />
                    </div>
                  </div><!--./row-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">State</label>
                    <div class="col-lg-6">
                      <input type="text" id="Ref" class="form-control form-control-lg mb-3 mb-lg-0"
                        formControlName="State" />
                    </div>
                  </div><!--./row-->

                  <div class="row mb-6">
                    <label class="col-lg-3 col-form-label fw-bold fs-6">Country</label>
                    <div class="col-lg-6">
                      <ng-select formControlName="Country" bindLabel="name" id="titleId">
                        <!-- <ng-option value="" selected>Select</ng-option> -->
                        <ng-option *ngFor="let country of CountryList" [value]="country.id">{{ country.countryName
                          }}</ng-option>
                      </ng-select>

                      <div class="col-sm-12 text-end p-0" *ngIf="i>0 && !isView">
                        <a href="javascript:void(0)" id="hiderepeateRule" (click)="removeAddress(i)" class="btn btn-icon-danger btn-text-danger btn-sm px-0">
                          <i class="bi bi-trash"></i> Delete
                        </a>
                      </div>
                      
                      <a href="javascript:void(0)" *ngIf="Addresses.length<2 && !isView" (click)="addAddress()" id="repeateRule" class="btn btn-bg-light btn-icon-primary btn-text-primary mt-3"> <i class="bi bi-plus"></i> Add Address</a>

                    </div>
                  </div><!--./row-->

                </div><!--./[formGroupName]-->
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="accordion-item" id="sec3">
        <h2 class="accordion-header" id="kt_accordion_1_header_3">
          <button class="accordion-button fs-4 fw-semibold" type="button" (click)="isSocialMedia = !isSocialMedia"
            [class.collapsed]="!isSocialMedia"  [ngClass]="isSave && SocialMediaForm.invalid ? 'border-error' : ''">
            Social Media
          </button>
        </h2>
        <div id="kt_accordion_1_body_3" class="accordion-collapse collapse" [class.show]="isSocialMedia">
          <div class="accordion-body">
            <form [formGroup]="SocialMediaForm">
              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Facebook Link</label>
                <div class="col-lg-6">
                  <input type="text" id="facebookLink" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="FacebookLink" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Instagram Link</label>
                <div class="col-lg-6">
                  <input type="text" id="InstagramLink" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="InstagramLink" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Twitter Link</label>
                <div class="col-lg-6">
                  <input type="text" id="twitterLink" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="TwitterLink" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">LinkedIn Link</label>
                <div class="col-lg-6">
                  <input type="text" id="linkedInLink" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="LinkedInLink" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Google+ Link</label>
                <div class="col-lg-6">
                  <input type="text" id="googleplusLink" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="GooglePlusLink" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">Skype Link</label>
                <div class="col-lg-6">
                  <input type="text" id="skypeLink" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="SkypeLink" />
                </div>
              </div>

              <div class="row mb-6">
                <label class="col-lg-3 col-form-label fw-bold fs-6">WeChat Link</label>
                <div class="col-lg-6">
                  <input type="text" id="WeChatLink" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="WeChatLink" />
                </div>
              </div>

              <div class="row mb-6">
                
               
                  <!-- <input type="text" id="Website" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="Website" /> -->
                    <label class="col-lg-3 col-form-label fw-bold fs-6">Personal Website</label>

                <div class="col-lg-6">
                  <input type="text" id="WebsiteLink" class="form-control form-control-lg mb-3 mb-lg-0"
                    formControlName="WebsiteLink" />
                </div>
              </div>


            </form>
          </div>
        </div>
      </div>
      
    </div>
    </div>

    <div *ngIf="selectedTab == 'tab2'">
      <div class="accordian-body py-5" style="padding-left: 40px">
        <div class="row mb-4">
          <div class="col-lg-6" *ngIf="!isAdd">
            <form [formGroup]="ContactNotesForm">
            <textarea
              id="notes-add-for-display"
              formControlName="Notes"
              class="form-control form-control-lg mb-3"
              [ngClass]="isSaveNotes && Notes.invalid ? 'border-error' : ''"
              type="text"
              placeholder="Enter Notes"
              rows="4"
            ></textarea>

            <div *ngIf="isSaveNotes && Notes.invalid" class="required-feedback">
              <div class="error-text">
                Notes is required
              </div>
            </div>
            
            <button (click)="SaveContactNotes()" class="btn btn-sm btn-primary">
              Submit
            </button>
          </form>
          </div>
        </div>
      </div>
      
      <div
        class="p-4"
        id="notes-add-for-display-1"
        *ngIf="!isAdd && contactNotes.length > 0"
      >
      <div id="display-notes-length" >
        <div class="card card-bordered w-100 mb-4" *ngFor="let n of contactNotes" >   
          <div class="card-body">    
              <div class="w-100 d-flex flex-stack mb-8">
                  <div class="d-flex align-items-center " >
                      <div class="d-flex flex-column fw-semibold fs-5 text-gray-600 text-dark">    
                          <div class="d-flex align-items-center" hidden>    
                              <a class="text-gray-800 fw-bold text-hover-primary fs-5 me-3">{{n?.createdBy}}</a>
                              <span class="m-0"></span>               
                          </div>
        
                          <span class="text-muted fw-semibold fs-6">{{ n?.createdDate  | date : "dd/MM/yyyy hh:mm:ss a " }}</span>     
                      </div>
                  </div>
              </div>
        
              <p class="fw-normal fs-5 text-gray-700 m-0">
                {{ n.notes }}
              </p> 
          </div>
        </div>
        </div>
      </div>
      
    </div>
    </div>
  </form>
  </div>
</div>
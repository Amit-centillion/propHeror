<div id="splash-screen" class="splash-screen" *ngIf="IsLoading">
  <img src="./assets/media/logos/prophero-small.svg" alt="PropHero logo" />
  <span>Loading ...</span>
</div>

<form [formGroup]="searchContactForm" novalidate="" class="form">
  <div  class="card-header align-items-center p-0 gap-2 gap-md-5">
    <!--begin::Actions-->
    <div class="d-flex w-100 justify-content-between">
      <div class="d-flex gap-2">
        <a class="btn btn-sm btn-light-primary" (click)="exportContact()">
          <i class="bi bi-upload"></i> Export
        </a>
      </div>
      <!--begin::Drawer toggle-->
      <a *ngIf="isAddContactPermission" (click)="onAdd()" class="kt_contact-details_toggle btn btn-sm btn-flex btn-primary fw-bold me-1">
        <i class="bi bi-plus fs-2"></i> Add Contact
      </a>
      <!--end::Drawer toggle-->
    </div>
    <!--end::Actions-->
    <!-- begin::Table container -->
    <!-- <button   id="kt_contact-details_toggle" (click)="openViewing()">Open Viewing for demo</button> -->
    <!-- <form [formGroup]="searchContactForm"> -->
    <div class="table-responsive">
      <!-- begin::Table -->
      <table id="listings_row" class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4">
        <!-- begin::Table head -->
        <thead class="fw-bold">
          <th class="w-40px">
            <div class="form-check form-check-sm form-check-custom form-check-solid p-0">
              <input class="form-check-input cursor-pointer" type="checkbox" data-kt-check="true" data-kt-check-target=".widget-9-check" [(ngModel)]="isSelectAllContact" [ngModelOptions]="{standalone: true}"  (change)="SelectAllContact($event)"/>
            </div>
          </th>

          <ng-container *ngFor="let column of columnOrder">
          <!--Basic Details-->
          <th *ngIf="column.isVisible && column.column == 'Reference'" class="min-w-120px" (click)="OnSort('Ref')"> Reference </th>
          <th *ngIf="column.isVisible && column.column == 'Assigned To'" class="min-w-120px" (click)="OnSort('AssignedTo')"> Assigned To </th>
          
          
          
          <th *ngIf="column.isVisible && column.column == 'Title'" class="min-w-120px" (click)="OnSort('Title')"> Title </th>
          <th *ngIf="column.isVisible && column.column == 'First Name'" class="min-w-120px" (click)="OnSort('FirstName')"> First Name </th>
          <th *ngIf="column.isVisible && column.column == 'Last Name'" class="min-w-120px" (click)="OnSort('LastName')"> Last Name </th>
          
          <!-- Contact Details -->
          <th *ngIf="column.isVisible && column.column == 'Personal Mobile'" class="min-w-120px" (click)="OnSort('PersonalMobile')"> Personal Mobile </th>
          <th *ngIf="column.isVisible && column.column == 'Work Mobile'" class="min-w-120px" (click)="OnSort('WorkMobile')"> Work Mobile </th>
          <th *ngIf="column.isVisible && column.column == 'Other Mobile'" class="min-w-120px" (click)="OnSort('OtherMobile')"> Other Mobile </th>
          <th *ngIf="column.isVisible && column.column == 'Personal Phone'" class="min-w-120px" (click)="OnSort('PersonalPhone')"> Personal Phone </th>
          <th *ngIf="column.isVisible && column.column == 'Work Phone'" class="min-w-120px" (click)="OnSort('WorkPhone')"> Work Phone </th>
          <th *ngIf="column.isVisible && column.column == 'Other Phone'" class="min-w-120px" (click)="OnSort('OtherPhone')"> Other Phone </th>
          <th *ngIf="column.isVisible && column.column == 'Personal Email'" class="min-w-120px" (click)="OnSort('PersonalEmail')"> Personal Email </th>
          <th *ngIf="column.isVisible && column.column == 'Work Email'" class="min-w-120px" (click)="OnSort('WorkEmail')"> Work Email </th>
          <th *ngIf="column.isVisible && column.column == 'Other Email'" class="min-w-120px" (click)="OnSort('OtherEmail')"> Other Email </th>
          <!-- <th class="min-w-120px" (click)="OnSort('PersonalFax')"> Personal Fax </th>
          <th class="min-w-120px" (click)="OnSort('WorkFax')"> Work Fax </th>
          <th class="min-w-120px" (click)="OnSort('OtherFax')"> Other Fax </th> -->
          <th *ngIf="column.isVisible && column.column == 'Personal PO Box'" class="min-w-120px" (click)="OnSort('PersonalPO')"> Personal PO Box</th>
          <th *ngIf="column.isVisible && column.column == 'Personal Address Line 1'" class="min-w-120px" (click)="OnSort('PersonalAddressLine1')"> Personal Address Line 1 </th>
          <th *ngIf="column.isVisible && column.column == 'Personal Address Line 2'" class="min-w-120px" (click)="OnSort('PersonalAddressLine2')"> Personal Address Line 2 </th>
          <th *ngIf="column.isVisible && column.column == 'Personal City'" class="min-w-120px" (click)="OnSort('PersonalCity')"> Personal City </th>
          <th *ngIf="column.isVisible && column.column == 'Personal Zip Code'" class="min-w-120px" (click)="OnSort('PersonalZipCode')"> Personal Zip Code </th>
          <th *ngIf="column.isVisible && column.column == 'Personal State'" class="min-w-120px" (click)="OnSort('PersonalState')"> Personal State </th>
          <th *ngIf="column.isVisible && column.column == 'Personal Country'" class="min-w-120px" (click)="OnSort('PersonalCountry')"> Personal Country </th>
          <th *ngIf="column.isVisible && column.column == 'Work PO Box'" class="min-w-120px" (click)="OnSort('WorkPO')"> Work PO Box</th>
          <th *ngIf="column.isVisible && column.column == 'Work Address Line 1'" class="min-w-120px" (click)="OnSort('WorkAddressLine1')"> Work Address Line 1 </th>
          <th *ngIf="column.isVisible && column.column == 'Work Address Line 2'" class="min-w-120px" (click)="OnSort('WorkAddressLine2')"> Work Address Line 2 </th>
          <th *ngIf="column.isVisible && column.column == 'Work City'" class="min-w-120px" (click)="OnSort('WorkCity')"> Work City </th>
          <th *ngIf="column.isVisible && column.column == 'Work Zip Code'" class="min-w-120px" (click)="OnSort('WorkZipCode')"> Work Zip Code </th>
          <th *ngIf="column.isVisible && column.column == 'Work State'" class="min-w-120px" (click)="OnSort('WorkState')"> Work State </th>
          <th *ngIf="column.isVisible && column.column == 'Work Country'" class="min-w-120px" (click)="OnSort('WorkCountry')"> Work Country </th>

          <!-- Social Media -->
          <th *ngIf="column.isVisible && column.column == 'Facebook Link'" class="min-w-120px" (click)="OnSort('FacebookLink')"> Facebook Link </th>
          <th *ngIf="column.isVisible && column.column == 'Instagram Link'" class="min-w-120px" (click)="OnSort('InstagramLink')"> Instagram Link </th>
          <th *ngIf="column.isVisible && column.column == 'Twitter Link'" class="min-w-120px" (click)="OnSort('TwitterLink')"> Twitter Link </th>
          <th *ngIf="column.isVisible && column.column == 'LinkedIn Link'" class="min-w-120px" (click)="OnSort('LinkedInLink')"> LinkedIn Link </th>
          <th *ngIf="column.isVisible && column.column == 'Google+ Link'" class="min-w-120px" (click)="OnSort('GooglePlusLink')"> Google+ Link </th>
          <th *ngIf="column.isVisible && column.column == 'Skype Link'" class="min-w-120px" (click)="OnSort('SkypeLink')"> Skype Link </th>


          <th *ngIf="column.isVisible && column.column == 'WeChat Link'" class="min-w-120px" (click)="OnSort('WeChatLink')"> WeChat Link </th>
          <!-- <th class="min-w-120px" (click)="OnSort('SocialWebsite')"> Social Website </th> -->
          <th *ngIf="column.isVisible && column.column == 'Personal Website'" class="min-w-120px" (click)="OnSort('WebsiteLink')"> Personal Website </th>

          <!-- Additional Info -->
          <th *ngIf="column.isVisible && column.column == 'VIP'" class="min-w-120px" (click)="OnSort('VIP')"> VIP </th>
          <th *ngIf="column.isVisible && column.column == 'Gender'" class="min-w-120px" (click)="OnSort('Gender')"> Gender </th>
          <th *ngIf="column.isVisible && column.column == 'Date of Birth'" class="min-w-120px" (click)="OnSort('DOB')"> Date of Birth </th>
          <th *ngIf="column.isVisible && column.column == 'Nationality'" class="min-w-120px" (click)="OnSort('Nationality1')"> Nationality </th>
          <th *ngIf="column.isVisible && column.column == 'Second Nationality'" class="min-w-120px" (click)="OnSort('Nationality2')"> Second Nationality  </th>
          <th *ngIf="column.isVisible && column.column == 'Religion'" class="min-w-120px" (click)="OnSort('Religion')"> Religion </th>
          <th *ngIf="column.isVisible && column.column == 'Native Language'" class="min-w-120px" (click)="OnSort('NativeLanguage')"> Native Language </th>
          <th *ngIf="column.isVisible && column.column == 'Second Language'" class="min-w-120px" (click)="OnSort('SecondLanguage')"> Second Language </th>

          <th *ngIf="column.isVisible && column.column == 'Contact Source'" class="min-w-120px" (click)="OnSort('ContactSource')"> Contact Source </th>
          <th *ngIf="column.isVisible && column.column == 'Company Name'" class="min-w-120px" (click)="OnSort('CompanyName')"> Company Name </th>
          <th *ngIf="column.isVisible && column.column == 'Designation'" class="min-w-120px" (click)="OnSort('Designation')"> Designation </th>
          <th *ngIf="column.isVisible && column.column == 'Website'" class="min-w-120px" (click)="OnSort('Website')"> Website </th>
          <th *ngIf="column.isVisible && column.column == 'Contact Type'" class="min-w-120px" (click)="OnSort('ContactType')"> Contact Type </th>
          <th *ngIf="column.isVisible && column.column == 'Created'" class="min-w-120px" (click)="OnSort('Created')"> Created  </th>
          <th *ngIf="column.isVisible && column.column == 'Created By'" class="min-w-120px" (click)="OnSort('CreatedBy')"> Created By </th>
          <th *ngIf="column.isVisible && column.column == 'Updated'" class="min-w-120px" (click)="OnSort('Updated')"> Updated  </th>
          <th *ngIf="column.isVisible && column.column == 'Updated By'" class="min-w-120px" (click)="OnSort('UpdatedBy')"> Updated By </th>
        </ng-container>
        </thead>
        <!-- end::Table head -->

        <!-- begin::Table Filter -->
        <thead id="filter">
          <!-- <form [formGroup]="searchContactForm"> -->
          <th></th>
          <ng-container *ngFor="let column of columnOrder">
          <th *ngIf="column.isVisible && column.column == 'Reference'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterRef" (keyup)="MinCharSearch($event,'Ref')"/></th>
          <th *ngIf="column.isVisible && column.column == 'Assigned To'">
            <ng-select formControlName="filterAssignee" bindLabel="name" (change)="filterContact()">
              <!-- <ng-option value="" selected>Select Assign To</ng-option> -->
                      <ng-option *ngFor="let assignee of assignToList" [value]="assignee.id">{{ assignee.name
                        }}</ng-option>
            </ng-select>
          </th>
          
        
        
        <th *ngIf="column.isVisible && column.column == 'Title'">
          <ng-select formControlName="filterTitle" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let title of titleList" [value]="title.id">{{ title.name }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'First Name'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterFirstName" (keyup)="MinCharSearch($event,'FirstName')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Last Name'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterLastName" (keyup)="MinCharSearch($event,'LastName')"/></th>
        
        <th *ngIf="column.isVisible && column.column == 'Personal Mobile'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalMobile" (keyup)="MinCharSearch($event,'PersonalMobile')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work Mobile'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkMobile" (keyup)="MinCharSearch($event,'WorkMobile')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Other Mobile'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterOtherMobile" (keyup)="MinCharSearch($event,'OtherMobile')"/></th>
       
        <th *ngIf="column.isVisible && column.column == 'Personal Phone'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalPhone" (keyup)="MinCharSearch($event,'PersonalPhone')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work Phone'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkPhone" (keyup)="MinCharSearch($event,'WorkPhone')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Other Phone'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterOtherPhone" (keyup)="MinCharSearch($event,'OtherPhone')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Personal Email'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalEmail" (keyup)="MinCharSearch($event,'PersonalEmail')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work Email'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkEmail" (keyup)="MinCharSearch($event,'WorkEmail')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Other Email'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterOtherEmail" (keyup)="MinCharSearch($event,'OtherEmail')"/></th>
        <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalFax" (keyup)="MinCharSearch($event,'PersonalFax')"/></th> -->
        <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkFax" (keyup)="MinCharSearch($event,'WorkFax')"/></th> -->
        <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterOtherFax" (keyup)="MinCharSearch($event,'OtherFax')"/></th> -->
        <th *ngIf="column.isVisible && column.column == 'Personal PO Box'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalPO" (keyup)="MinCharSearch($event,'PersonalPO')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Personal Address Line 1'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalAddressLine1" (keyup)="MinCharSearch($event,'PersonalAddressLine1')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Personal Address Line 2'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalAddressLine2" (keyup)="MinCharSearch($event,'PersonalAddressLine2')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Personal City'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalCity" (keyup)="MinCharSearch($event,'PersonalCity')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Personal Zip Code'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalZipCode" (keyup)="MinCharSearch($event,'PersonalZipCode')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Personal State'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterPersonalState" (keyup)="MinCharSearch($event,'PersonalState')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Personal Country'">
          <ng-select formControlName="filterPersonalCountry" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let country of CountryList" [value]="country.countryName">{{ country.countryName
              }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Work PO Box'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkPO" (keyup)="MinCharSearch($event,'WorkPO')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work Address Line 1'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkAddressLine1" (keyup)="MinCharSearch($event,'WorkAddressLine1')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work Address Line 2'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkAddressLine2" (keyup)="MinCharSearch($event,'WorkAddressLine2')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work City'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkCity" (keyup)="MinCharSearch($event,'WorkCity')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work Zip Code'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkZipCode" (keyup)="MinCharSearch($event,'WorkZipCode')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work State'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWorkState" (keyup)="MinCharSearch($event,'WorkState')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Work Country'">
          <ng-select formControlName="filterWorkCountry" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let country of CountryList" [value]="country.countryName">{{ country.countryName
              }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Facebook Link'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterFacebookLink" (keyup)="MinCharSearch($event,'FacebookLink')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Instagram Link'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterInstagramLink" (keyup)="MinCharSearch($event,'InstagramLink')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Twitter Link'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterTwitterLink" (keyup)="MinCharSearch($event,'TwitterLink')"/></th>
        <th *ngIf="column.isVisible && column.column == 'LinkedIn Link'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterLinkedInLink" (keyup)="MinCharSearch($event,'LinkedInLink')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Google+ Link'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterGooglePlusLink" (keyup)="MinCharSearch($event,'GoooglePlusLink')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Skype Link'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterSkypeLink" (keyup)="MinCharSearch($event,'SkypeLink')"/></th>
        
        
        <th *ngIf="column.isVisible && column.column == 'WeChat Link'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWeChatLink" (keyup)="MinCharSearch($event,'WeChatLink')"/></th>
        <!-- <th><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterSocialWebsite" (keyup)="MinCharSearch($event,'SocailWebsite')"/></th> -->
        <th *ngIf="column.isVisible && column.column == 'Personal Website'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWebsiteLink" (keyup)="MinCharSearch($event,'WebsiteLink')"/></th>
        <th *ngIf="column.isVisible && column.column == 'VIP'">
          <ng-select formControlName="filterVip" bindLabel="name" (change)="filterContact()">
                    <ng-option [value]="1">Yes</ng-option>
                    <ng-option [value]="0">No</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Gender'">
          <ng-select formControlName="filterGender" bindLabel="name" id="titleId" (change)="filterContact()">
          <ng-option *ngFor="let gender of GenderList" [value]="gender.id">{{ gender.name }}</ng-option>
        </ng-select></th>
        <th *ngIf="column.isVisible && column.column == 'Date of Birth'">

          <div class="d-flex gap-2 w-300px">
            <div class="position-relative w-50">
              <input type="date" formControlName="filterFromDOB" class="form-control mb-3 mb-lg-0" (change)="filterContact()"/>
              <span class="input-date-placeholder" for="filterFromDOB">From</span>
            </div>
            <div class="position-relative w-50">
              <input type="date" formControlName="filterToDOB" class="form-control mb-3 mb-lg-0" (change)="filterContact()"/>
              <span class="input-date-placeholder" for="filterToDOB">To</span>
            </div>
          </div><!--./d-flex-->
        </th>
        <th *ngIf="column.isVisible && column.column == 'Nationality'">
          <ng-select formControlName="filterNationality1" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let nationality of NationalitiesList" [value]="nationality.id">{{
              nationality.countryName }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Second Nationality'">
          <ng-select formControlName="filterNationality2" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let nationality of NationalitiesList" [value]="nationality.id">{{
              nationality.countryName }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Religion'">
          <ng-select formControlName="filterReligion" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let religion of ReligionList" [value]="religion.id">{{ religion.name
              }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Native Language'">
          <ng-select formControlName="filterNativeLanguage" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let language of LanguagesList" [value]="language.id">{{ language.languageName
              }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Second Language'">
          <ng-select formControlName="filterSecondLanguage" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let language of LanguagesList" [value]="language.id">{{ language.languageName
              }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Contact Source'">
          <ng-select formControlName="filterContactSource" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let contactsource of ContactSourceList" [value]="contactsource.id">{{
              contactsource.name }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Company Name'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterCompanyName" (keyup)="MinCharSearch($event,'CompanyName')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Designation'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterDesignation" (keyup)="MinCharSearch($event,'Designation')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Website'"><input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterWesbite" (keyup)="MinCharSearch($event,'Website')"/></th>
        <th *ngIf="column.isVisible && column.column == 'Contact Type'">
          <ng-select formControlName="filterContactType" bindLabel="name" id="titleId" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select</ng-option> -->
            <ng-option *ngFor="let contactType of ContactTypeList" [value]="contactType.id">{{ contactType.name
              }}</ng-option>
          </ng-select>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Created'">
          <div class="d-flex gap-2 w-300px">
            <div class="position-relative w-50">
              <input type="date" class="form-control mb-3 mb-lg-0" formControlName="filterCreatedFrom" (change)="filterContact()"/>
              <span class="input-date-placeholder" for="filterCreatedFrom">From</span>
            </div>
            <div class="position-relative w-50">
              <input type="date" class="form-control mb-3 mb-lg-0" formControlName="filterCreatedTo" (change)="filterContact()"/>
              <span class="input-date-placeholder" for="filterCreatedTo">To</span>
            </div>
          </div>
        </th>
        <th *ngIf="column.isVisible && column.column == 'Created By'">
          <ng-select formControlName="filterCreatedBy" bindLabel="name" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select Assign To</ng-option> -->
            <ng-option
            *ngFor="let user of userList"
            [value]="user.userId"
            >{{ user.userName }}</ng-option>
          </ng-select>
        <th *ngIf="column.isVisible && column.column == 'Updated'">
          <div class="d-flex gap-2 w-300px">
            <div class="position-relative w-50">
              <input type="date" class="form-control mb-3 mb-lg-0" formControlName="filterUpdatedFrom" (change)="filterContact()"/>
              <span class="input-date-placeholder" for="filterUpdatedFrom">From</span>
            </div>
            <div class="position-relative w-50">
              <input type="date" class="form-control mb-3 mb-lg-0" formControlName="filterUpdatedTo" (change)="filterContact()"/>
              <span class="input-date-placeholder" for="filterUpdatedTo">To</span>
            </div>
          </div><!--./d-flex-->
        </th>
        <th *ngIf="column.isVisible && column.column == 'Updated By'">
          <ng-select formControlName="filterUpdatedBy" bindLabel="name" (change)="filterContact()">
            <!-- <ng-option value="" selected>Select Assign To</ng-option> -->
            <ng-option
            *ngFor="let user of userList"
            [value]="user.userId"
            >{{ user.userName }}</ng-option>
          </ng-select>
          </th>
        </ng-container>
          <!-- <input type="text" placeholder="Min. 3 chars" class="form-control mb-3 mb-lg-0" formControlName="filterUpdatedBy"/></th> -->
      <!-- </form> -->
        </thead>
        
        <!-- end::Table Filter -->

        <!-- begin::Table Body -->
        <tbody *ngIf="ContactDetailsList.length > 0">
          <tr *ngFor="let data of ContactDetailsList | paginate : { id:'contact_data_table',itemsPerPage: pageSize, currentPage: pageNumber, totalItems: totalRecord}" >
            <th class="w-40px align-middle">
              <div class="form-check form-check-sm form-check-custom form-check-solid p-0">
                <input class="form-check-input cursor-pointer" type="checkbox" [(ngModel)]="data.isSelected" [ngModelOptions]="{standalone: true}" value="{{ data.Id }}" data-kt-check="true" data-kt-check-target=".widget-9-check" (change)="SelectContact($event,data.id)"/>
              </div>
            </th>
            <ng-container *ngFor="let column of columnOrder">
            <th *ngIf="column.isVisible && column.column == 'Reference'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.ref}}</th>
            <th *ngIf="column.isVisible && column.column == 'Assigned To'" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">
              <div class="d-flex gap-2 align-items-center">
                <ngx-avatar *ngIf="data?.profileImage == null || data?.profileImage == ''" size="26" class="avatar" [name]="data?.agentName"></ngx-avatar>
                <img *ngIf="data?.profileImage != null && data?.profileImage != ''" [src]="imgUrl + data?.profileImage" alt="Image Preview" [style.border-radius.px]="50" [style.width.px]="26" [style.height.px]="26">
                <!-- <ngx-avatar size="26" class="avatar" [name]="data?.agentName"></ngx-avatar> -->
                {{data?.agentName}}
              </div>
            </th>
            <!--Reference & Status-->
            <th *ngIf="column.isVisible && column.column == 'Title'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.titleName}}</th>
            <th *ngIf="column.isVisible && column.column == 'First Name'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.firstName}}</th>
            <th *ngIf="column.isVisible && column.column == 'Last Name'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.lastName}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal Mobile'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getMobile(1,data?.mobile)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work Mobile'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getMobile(2,data?.mobile)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Other Mobile'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getMobile(3,data?.mobile)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal Phone'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getPhone(1,data?.phone)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work Phone'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getPhone(2,data?.phone)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Other Phone'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getPhone(3,data?.phone)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal Email'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getEmail(1,data?.email)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work Email'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getEmail(2,data?.email)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Other Email'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getEmail(3,data?.email)}}</th>
            <!-- <th>{{getFax(1,data?.fax)}}</th>
            <th>{{getFax(2,data?.fax)}}</th>
            <th>{{getFax(3,data?.fax)}}</th> -->
            <th *ngIf="column.isVisible && column.column == 'Personal PO Box'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getPO(1,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal Address Line 1'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getAddressLine1(1,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal Address Line 2'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getAddressLine2(1,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal City'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getCity(1,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal Zip Code'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getZipCode(1,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal State'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getState(1,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Personal Country'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getCountry(1,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work PO Box'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getPO(2,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work Address Line 1'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getAddressLine1(2,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work Address Line 2'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getAddressLine2(2,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work City'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getCity(2,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work Zip Code'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getZipCode(2,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work State'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getState(2,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Work Country'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{getCountry(2,data?.contactAddress)}}</th>
            <th *ngIf="column.isVisible && column.column == 'Facebook Link'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.facebookLink}}</th>
            <th *ngIf="column.isVisible && column.column == 'Instagram Link'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.instagramLink}}</th>
            <th *ngIf="column.isVisible && column.column == 'Twitter Link'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.twitterLink}}</th>
            <th *ngIf="column.isVisible && column.column == 'LinkedIn Link'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.linkedinLink}}</th>
            <th *ngIf="column.isVisible && column.column == 'Google+ Link'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.googlePlusLink}}</th>
            <th *ngIf="column.isVisible && column.column == 'Skype Link'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.skypeLink}}</th>
            <th *ngIf="column.isVisible && column.column == 'WeChat Link'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.weChatLink}}</th>
            <!-- <th>{{data?.websites}}</th> -->
            <th *ngIf="column.isVisible && column.column == 'Personal Website'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.websiteLink}}</th>
            <th *ngIf="column.isVisible && column.column == 'VIP'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.vip ? 'Yes':'No'}}</th>
            <th *ngIf="column.isVisible && column.column == 'Gender'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.genderName}}</th>
            <th *ngIf="column.isVisible && column.column == 'Date of Birth'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.dateOfBirth | date: "dd/MM/yyyy"}}</th>
            <th *ngIf="column.isVisible && column.column == 'Nationality'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.nationality1}}</th>
            <th *ngIf="column.isVisible && column.column == 'Second Nationality'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.nationality2}}</th>
            <th *ngIf="column.isVisible && column.column == 'Religion'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.religionName}}</th>
            <th *ngIf="column.isVisible && column.column == 'Native Language'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.nativeLanguage}}</th>
            <th *ngIf="column.isVisible && column.column == 'Second Language'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.secondLanguage}}</th>
            <th *ngIf="column.isVisible && column.column == 'Contact Source'"class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.sourceOfListing}}</th>
            <th *ngIf="column.isVisible && column.column == 'Company Name'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.companyName}}</th>
            <th *ngIf="column.isVisible && column.column == 'Designation'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.designation}}</th>
            <th *ngIf="column.isVisible && column.column == 'Website'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.website}}</th>
            <th *ngIf="column.isVisible && column.column == 'Contact Type'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.contactTypeName}}</th>
            <th *ngIf="column.isVisible && column.column == 'Created'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.created | date: "dd/MM/yyyy"}}</th>
            <th *ngIf="column.isVisible && column.column == 'Created By'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.createdBy}}</th>
            <th *ngIf="column.isVisible && column.column == 'Updated'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.updated | date: "dd/MM/yyyy"}}</th>
            <th *ngIf="column.isVisible && column.column == 'Updated By'" class="align-middle" [ngClass]="isDraweropen == false ? 'kt_contact-details_toggle':'' " (click)="openViewing(data?.id)">{{data?.updatedBy}}</th>
          </ng-container>
          </tr>
        </tbody>
        <!-- end::Table Body -->
      </table>
      <div class="text-center mt-5 mb-5" *ngIf="ContactDetailsList && ContactDetailsList?.length == 0"> Record not available </div>
      <!-- end::Table -->
   
    </div>
    <div class="d-flex justify-content-between w-100 flex-column-reverse">
      
      <pagination-controls *ngIf="ContactDetailsList.length > 0" (pageChange)="renderPage($event)" id="contact_data_table"></pagination-controls>
      <span class="d-flex justify-content-between mb-3">
        <div class="d-flex align-items-center">
          <span>
            Showing {{ContactDetailsList?.length}} of <b>{{totalRecord}}</b> Contacts
      </span>
      </div>
      <div>
        <a
        class="btn btn-sm btn-light-primary"
        data-kt-menu-trigger="{default: 'click', lg: 'hover'}"
        (click)="openColumnSettings()"
      >
        <i class="bi bi-gear"></i> Column Settings
      </a>
      </div>
        </span>
      <!-- <span class="d-block mb-3">Showing {{ContactDetailsList?.length}} of <b>{{totalRecord}}</b> Contacts</span> -->
    </div>
<!-- </form> -->
  </div>
    
</form>


<ng-template #columnSettingmodal>
  <div class="modal-content advance-filter-modal">
    <div class="modal-header py-3">
      <!--begin::Modal title-->
      <h4 class="m-0">Manage Columns</h4>
      <!--end::Modal title-->
      <div
        class="btn btn-sm btn-icon btn-active-color-primary"
        (click)="closeColumnSettings()"
      >
        <i class="ki-duotone ki-cross fs-1">
          <span class="path1"></span>
          <span class="path2"></span>
        </i>
      </div>
    </div>
    <div class="modal-body">
      <!--begin::Form-->
      <div class="advance-filter">
        <div cdkDropList class="column-list" (cdkDropListDropped)="drop($event)">
          <div class="column-box" *ngFor="let column of tempcolumnOrder" cdkDragLockAxis="y" cdkDrag >
            <input type="checkbox" [(ngModel)]="column.isVisible">
            <span class="ml-2">{{column.column}}</span>
          </div>
        </div>
        <!-- <div class="row " cdkDropList (cdkDropListDropped)="drop($event)">
          <div class="col-lg-12 dragColumn mb-6" *ngFor="let column of tempcolumnOrder" cdkDrag>
            <input type="checkbox" [(ngModel)]="column.isVisible">
            <span>{{column.column}}</span>
          </div>
        </div> -->
      </div>
    </div>
    <!--end::Form-->
    <div class="modal-footer">
      <button
        type="reset"
        class="btn btn-sm btn-light btn-active-light-primary me-2"
        data-kt-menu-dismiss="true"
        (click)="closeColumnSettings()"
      >
        Cancel
      </button>
      <button
        type="submit"
        class="btn btn-sm btn-primary"
        data-kt-menu-dismiss="true"
        (click)="saveColumnSettings()"
      >
        Apply
      </button>
    </div>
  </div>
</ng-template>